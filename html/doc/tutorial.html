
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>HTSQL Tutorial &mdash; HTSQL</title>
    
    <link rel="stylesheet" href="../_static/common.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/htsqldoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/htrafdemo.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.3.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/htrafdemo.js"></script>
  
    <link rel="top" title="HTSQL" href="../index.html" />
    <link rel="up" title="HTSQL Documentation" href="index.html" />
    <link rel="next" title="HTSQL Reference" href="ref/index.html" />
    <link rel="prev" title="HTSQL Handbook" href="handbook.html" />
  <link rel="alternate" type="application/rss+xml" title="HTSQL News" href="http://htsql.org/index.rss" />
 
  </head>
  <body>

  <div class="header">
    <div class="header-inner">
      <a href="/"><img class="header-logo" src="../_static/rabbit-logo.png" alt="HTSQL(tm)"></a>
      <ul class="navigation">
        <li><a href="/blog/">News</a></li>
        <li><a href="/doc/">Documentation</a></li>
        <li><a href="/gallery/">Gallery</a></li>
        <li><a href="/download/">Download</a></li>
        <li><a href="/community/">Community</a></li>
      </ul>
      <div id="searchbox" style="display: none">
        <form class="search" action="../search.html" method="get">
          <input class="search-input" type="text" name="q" size="20" placeholder="Search&hellip;" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
      </div>
      <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
  </div>



    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="htsql-tutorial">
<h1>HTSQL Tutorial<a class="headerlink" href="#htsql-tutorial" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#getting-started" id="id1">Getting Started</a></li>
<li><a class="reference internal" href="#relating-and-aggregating-data" id="id2">Relating and Aggregating Data</a></li>
<li><a class="reference internal" href="#calculations-references" id="id3">Calculations &amp; References</a></li>
<li><a class="reference internal" href="#projections" id="id4">Projections</a></li>
<li><a class="reference internal" href="#logical-expressions" id="id5">Logical Expressions</a></li>
<li><a class="reference internal" href="#types-and-functions" id="id6">Types and Functions</a></li>
</ul>
</div>
<p><em>A query language for the accidental programmer</em></p>
<p>HTSQL makes accessing data as easy as browsing the web.  An HTSQL
processor translates web requests into relational database queries and
returns the results in a form ready for display or processing.
Information in a database can then be directly accessed from a browser,
a mobile application, statistics tool, or a rich Internet application.
Like any web resource, an HTSQL service can be secured via encryption
and standard authentication mechanisms &#8211; either on your own private
intranet or publicly on the Internet.</p>
<p>HTSQL users are data experts.  They may be business users, but they can
also be technical users who value data transparency and direct access.
Business users can use HTSQL to quickly search the database and create
reports without the help of IT.  Programmers can use it as data access
layer for web applications.  HTSQL can be installed by DBAs to provide
easy, safe database access for power users.</p>
<p>HTSQL is a schema-driven URI-to-SQL translator that takes a request over
HTTP, converts it to a set of SQL queries, executes these queries in a
single transaction, and returns the results in a format (CSV, HTML,
JSON, etc.) requested by the user agent:</p>
<img alt="HTSQL as a web service" class="diagram align-center" height="243" src="../_images/htsql-web-service.png" width="657" />
<p>The HTSQL query processor does heavy lifting for you.  Using
relationships between tables as permitted links, the HTSQL processor
translates graph-oriented web requests into corresponding relational
queries.  This translation can be especially involved for sophisticated
requests having projections and aggregates.  For complex cases, an
equivalent hand-written SQL query is tedious to write and non-obvious
without extensive training.  By doing graph to relational mapping on
your behalf, HTSQL permits your time to be spent exploring information
instead of debugging.</p>
<p>The HTSQL language is easy to use.  We&#8217;ve designed HTSQL to be broadly
usable by semi-technical domain experts, or what we call <em>accidental
programmers</em>.  We&#8217;ve field tested the toolset with business analysts,
medical researchers, statisticians, and web application developers. By
using a formalized directed graph as the underpinning of the query
algebra and by using a URI-inspired syntax over HTTP, we&#8217;ve obtained a
careful balance between clarity and functionality.</p>
<p>We hope you like it.</p>
<div class="section" id="getting-started">
<h2><a class="toc-backref" href="#id1">Getting Started</a><a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>The following examples show output from the HTSQL command-line system,
which is plain text.  HTSQL can output HTML, CSV, XML and many other
formats.  This makes it suitable not only for direct queries, but as a
data access layer for application development.</p>
<p>We&#8217;ll use a fictional university that maintains a database for its
student enrollment system.  There are four tables that describe the
business units of the university and their relationship to the
courses offered:</p>
<img alt="Administrative Directory schema" class="diagram align-center" height="392" src="../_images/administrative-directory-schema.png" width="587" />
<p>The university consists of schools, which administer one or more
degree-granting programs.  Departments are associated with a school
and offer courses.  Further on in the tutorial we will introduce
other tables such as student, instructor and enrollment.</p>
<div class="section" id="basic-expressions">
<h3>Basic Expressions<a class="headerlink" href="#basic-expressions" title="Permalink to this headline">¶</a></h3>
<p>HTSQL requests start with a forward-slash <tt class="docutils literal"><span class="pre">/</span></tt>.  To return all rows and
columns from the school table, sorted by primary key, write:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="69%" />
<col width="19%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">campus</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">art</td>
<td class="htsql-text-type">School of Art &amp; Design</td>
<td class="htsql-text-type">old</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">bus</td>
<td class="htsql-text-type">School of Business</td>
<td class="htsql-text-type">south</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">edu</td>
<td class="htsql-text-type">College of Education</td>
<td class="htsql-text-type">old</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">In this tutorial query results are shown truncated.  Click
on any example request to open it at demo.htsql.org and see
the complete output.</p>
</div>
<p>Scalar expressions, including arithmetic and boolean operations, can be
written directly:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/(3%2B4)*6" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/(3%2B4)*6" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="p">(</span><span class="m">3</span><span class="o">+</span><span class="m">4</span><span class="p">)</span><span class="o">*</span><span class="m">6</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
</thead>
<tbody valign="top">
<tr class="row-odd"><td class="htsql-integer-type">42</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>HTSQL has many built-in functions.  For instance you could use the
function <tt class="docutils literal"><span class="pre">count()</span></tt> to get the number of rows in a table:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/count(school)" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/count(school)" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nf">count</span><span class="p">(</span><span class="nb">school</span><span class="p">)</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
</thead>
<tbody valign="top">
<tr class="row-odd"><td class="htsql-integer-type">9</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>HTSQL uses a regular and intuitive syntax for expressions ranging from
table selection to complex calculation.</p>
</div>
<div class="section" id="choosing-columns">
<h3>Choosing Columns<a class="headerlink" href="#choosing-columns" title="Permalink to this headline">¶</a></h3>
<p>Use a <em>selector</em>, marked with <tt class="docutils literal"><span class="pre">{</span></tt> curley braces <tt class="docutils literal"><span class="pre">}</span></tt>, to specify
more than one output column:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/{count(school),%20count(program),%20count(department)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/{count(school),%20count(program),%20count(department)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="p">{</span><span class="nf">count</span><span class="p">(</span><span class="nb">school</span><span class="p">),</span> <span class="nf">count</span><span class="p">(</span><span class="nb">program</span><span class="p">),</span> <span class="nf">count</span><span class="p">(</span><span class="nb">department</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="32%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">count(school)</th>
<th class="head">count(program)</th>
<th class="head">count(department)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-integer-type">9</td>
<td class="htsql-integer-type">40</td>
<td class="htsql-integer-type">27</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>When returning data from a table, use a selector to choose columns for
display:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program{school_code,%20code,%20title}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program{school_code,%20code,%20title}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">program</span><span class="p">{</span><span class="nb">school_code</span><span class="p">,</span> <span class="nb">code</span><span class="p">,</span> <span class="nb">title</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="14%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">school_code</th>
<th class="head">code</th>
<th class="head">title</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">art</td>
<td class="htsql-text-type">gart</td>
<td class="htsql-text-type">Post Baccalaureate in Art History</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">art</td>
<td class="htsql-text-type">uhist</td>
<td class="htsql-text-type">Bachelor of Arts in Art History</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">art</td>
<td class="htsql-text-type">ustudio</td>
<td class="htsql-text-type">Bachelor of Arts in Studio Art</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">bus</td>
<td class="htsql-text-type">gecon</td>
<td class="htsql-text-type">Master of Arts in Economics</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In addition to table attributes, you could select arbitrary expressions.
The following example displays, for each school record, the school&#8217;s
name and the number of associated departments:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school{name,%20count(department)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school{name,%20count(department)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nb">department</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="56%" />
<col width="44%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">count(department)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">School of Art &amp; Design</td>
<td class="htsql-integer-type">1</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">School of Business</td>
<td class="htsql-integer-type">3</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">College of Education</td>
<td class="htsql-integer-type">2</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">School of Engineering</td>
<td class="htsql-integer-type">4</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>To title an output column, use the <tt class="docutils literal"><span class="pre">:as</span></tt> decorator:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school{name,%20count(department)%20:as%20'%23%20of%20Dept.'}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school{name,%20count(department)%20:as%20'%23%20of%20Dept.'}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nb">department</span><span class="p">)</span> <span class="p">:</span><span class="nf">as</span> <span class="s">&#39;%23 of Dept.&#39;</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="69%" />
<col width="31%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">#&nbsp;of&nbsp;Dept.</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">School of Art &amp; Design</td>
<td class="htsql-integer-type">1</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">School of Business</td>
<td class="htsql-integer-type">3</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">College of Education</td>
<td class="htsql-integer-type">2</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Since HTSQL is a web query language, there are two characters that have
special meaning: <tt class="docutils literal"><span class="pre">%</span></tt> is used to encode reserved and unprintable
characters as hexadecimal UTF-8 octets; <tt class="docutils literal"><span class="pre">#</span></tt> represents query fragments
that can be truncated by your browser.   Hence, these characters must be
percent-encoded in HTSQL queries: <tt class="docutils literal"><span class="pre">%</span></tt> is written <tt class="docutils literal"><span class="pre">%25</span></tt>; <tt class="docutils literal"><span class="pre">#</span></tt> is
written <tt class="docutils literal"><span class="pre">%23</span></tt>.  Depending upon the browser, other characters may be
percent-encoded, for example, the space `` `` may show up as <tt class="docutils literal"><span class="pre">%20</span></tt>.</p>
</div>
<div class="section" id="linking-data">
<h3>Linking Data<a class="headerlink" href="#linking-data" title="Permalink to this headline">¶</a></h3>
<p>In our example schema, each <tt class="docutils literal"><span class="pre">program</span></tt> is administered by a <tt class="docutils literal"><span class="pre">school</span></tt>.
Since the HTSQL processor knows about this relationship, it is possible
to link data accordingly:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program{school.name,%20title}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program{school.name,%20title}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">program</span><span class="p">{</span><span class="nb">school</span><span class="p">.</span><span class="nb">name</span><span class="p">,</span> <span class="nb">title</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">title</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">School of Art &amp; Design</td>
<td class="htsql-text-type">Post Baccalaureate in Art History</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">School of Art &amp; Design</td>
<td class="htsql-text-type">Bachelor of Arts in Art History</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">School of Art &amp; Design</td>
<td class="htsql-text-type">Bachelor of Arts in Studio Art</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>It is possible to link data through several relationships.  Since <tt class="docutils literal"><span class="pre">course</span></tt>
is offered by a <tt class="docutils literal"><span class="pre">department</span></tt> which belongs to a <tt class="docutils literal"><span class="pre">school</span></tt>, we can write:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course{department.school.name,%20department.name,%20title}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course{department.school.name,%20department.name,%20title}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="p">{</span><span class="nb">department</span><span class="p">.</span><span class="nb">school</span><span class="p">.</span><span class="nb">name</span><span class="p">,</span> <span class="nb">department</span><span class="p">.</span><span class="nb">name</span><span class="p">,</span> <span class="nb">title</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="17%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">name</th>
<th class="head">title</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">School of Business</td>
<td class="htsql-text-type">Accounting</td>
<td class="htsql-text-type">Practical Bookkeeping</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">School of Business</td>
<td class="htsql-text-type">Accounting</td>
<td class="htsql-text-type">Introduction to Accounting</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">School of Business</td>
<td class="htsql-text-type">Accounting</td>
<td class="htsql-text-type">Accounting Information Systems</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">School of Business</td>
<td class="htsql-text-type">Accounting</td>
<td class="htsql-text-type">Financial Accounting</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This request can be shortened a bit by collapsing the duplicate mention
of <tt class="docutils literal"><span class="pre">department</span></tt>; the resulting request is equivalent:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course{department{school.name,%20name},%20title}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course{department{school.name,%20name},%20title}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="p">{</span><span class="nb">department</span><span class="p">{</span><span class="nb">school</span><span class="p">.</span><span class="nb">name</span><span class="p">,</span> <span class="nb">name</span><span class="p">},</span> <span class="nb">title</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
<p>For cases where you don&#8217;t wish to specify each column explicitly, use
the wildcard <tt class="docutils literal"><span class="pre">*</span></tt> selector.  The request below returns all columns from
<tt class="docutils literal"><span class="pre">department</span></tt> and all columns from its correlated <tt class="docutils literal"><span class="pre">school</span></tt>:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department{*,%20school.*}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department{*,%20school.*}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">{</span><span class="o">*</span><span class="p">,</span> <span class="nb">school</span><span class="p">.</span><span class="o">*</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="20%" />
<col width="16%" />
<col width="6%" />
<col width="41%" />
<col width="9%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
<th class="head">code</th>
<th class="head">name</th>
<th class="head">campus</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-text-type">Accounting</td>
<td class="htsql-text-type">bus</td>
<td class="htsql-text-type">bus</td>
<td class="htsql-text-type">School of Business</td>
<td class="htsql-text-type">south</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">arthis</td>
<td class="htsql-text-type">Art History</td>
<td class="htsql-text-type">la</td>
<td class="htsql-text-type">la</td>
<td class="htsql-text-type">School of Arts and Humanities</td>
<td class="htsql-text-type">old</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">astro</td>
<td class="htsql-text-type">Astronomy</td>
<td class="htsql-text-type">ns</td>
<td class="htsql-text-type">ns</td>
<td class="htsql-text-type">School of Natural Sciences</td>
<td class="htsql-text-type">old</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">be</td>
<td class="htsql-text-type">Bioengineering</td>
<td class="htsql-text-type">eng</td>
<td class="htsql-text-type">eng</td>
<td class="htsql-text-type">School of Engineering</td>
<td class="htsql-text-type">north</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Since the HTSQL processor knows about relationships between tables in
your relational database, linking tables in your reports is trivial.</p>
</div>
<div class="section" id="filtering-data">
<h3>Filtering Data<a class="headerlink" href="#filtering-data" title="Permalink to this headline">¶</a></h3>
<p>Use the filter operator <tt class="docutils literal"><span class="pre">?</span></tt> to show only data that satisfies some
criteria. For example, to return departments in the School of
Engineering we can write:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department?school_code='eng'" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department?school_code='eng'" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="o">?</span><span class="nb">school_code</span><span class="o">=</span><span class="s">&#39;eng&#39;</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="59%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">be</td>
<td class="htsql-text-type">Bioengineering</td>
<td class="htsql-text-type">eng</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">comp</td>
<td class="htsql-text-type">Computer Science</td>
<td class="htsql-text-type">eng</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">ee</td>
<td class="htsql-text-type">Electrical Engineering</td>
<td class="htsql-text-type">eng</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">me</td>
<td class="htsql-text-type">Mechanical Engineering</td>
<td class="htsql-text-type">eng</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This request returns all records in the <tt class="docutils literal"><span class="pre">department</span></tt> table where the
column <tt class="docutils literal"><span class="pre">school_code</span></tt> is equal to <tt class="docutils literal"><span class="pre">'eng'</span></tt>.  In HTSQL, <em>literal</em>
values are single quoted so that <tt class="docutils literal"><span class="pre">'eng'</span></tt> isn&#8217;t confused with a column
name.</p>
<p>For a case-insensitive substring match, use the <tt class="docutils literal"><span class="pre">~</span></tt> operator:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program?title~'lit'" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program?title~'lit'" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">program</span><span class="o">?</span><span class="nb">title</span><span class="o">~</span><span class="s">&#39;lit&#39;</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="11%" />
<col width="50%" />
<col width="8%" />
<col width="16%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">school_code</th>
<th class="head">code</th>
<th class="head">title</th>
<th class="head">degree</th>
<th class="head">part_of_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">edu</td>
<td class="htsql-text-type">glited</td>
<td class="htsql-text-type">Master of Arts in Literacy Education</td>
<td class="htsql-text-type">ma</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">la</td>
<td class="htsql-text-type">upolisci</td>
<td class="htsql-text-type">Bachelor of Arts in Political Science</td>
<td class="htsql-text-type">ba</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Often times we want to compare a column against values from a list.  The
next example returns rows from the <tt class="docutils literal"><span class="pre">program</span></tt> table for the &#8220;Bachelors
of Arts&#8221; (<tt class="docutils literal"><span class="pre">'ba'</span></tt>) or &#8220;Bachelors of Science&#8221; (<tt class="docutils literal"><span class="pre">'bs'</span></tt>) degrees:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program?degree={'ba','bs'}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program?degree={'ba','bs'}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">program</span><span class="o">?</span><span class="nb">degree</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;ba&#39;</span><span class="p">,</span><span class="s">&#39;bs&#39;</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="10%" />
<col width="46%" />
<col width="9%" />
<col width="18%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">school_code</th>
<th class="head">code</th>
<th class="head">title</th>
<th class="head">degree</th>
<th class="head">part_of_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">art</td>
<td class="htsql-text-type">uhist</td>
<td class="htsql-text-type">Bachelor of Arts in Art History</td>
<td class="htsql-text-type">ba</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">art</td>
<td class="htsql-text-type">ustudio</td>
<td class="htsql-text-type">Bachelor of Arts in Studio Art</td>
<td class="htsql-text-type">ba</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-even"><td class="htsql-text-type">bus</td>
<td class="htsql-text-type">uacct</td>
<td class="htsql-text-type">B.S. in Accounting</td>
<td class="htsql-text-type">bs</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Complex filters can be created using boolean connectors, such as the
conjunction (<tt class="docutils literal"><span class="pre">&amp;</span></tt>), alternation (<tt class="docutils literal"><span class="pre">|</span></tt>), and negation (<tt class="docutils literal"><span class="pre">!</span></tt>)
operators.  The following request returns programs in the &#8220;School of
Business&#8221; that do not grant a &#8220;Bachelor of Science&#8221; degree:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program?school.code='bus'&amp;degree!='bs'" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program?school.code='bus'&amp;degree!='bs'" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">program</span><span class="o">?</span><span class="nb">school</span><span class="p">.</span><span class="nb">code</span><span class="o">=</span><span class="s">&#39;bus&#39;</span><span class="o">&amp;</span><span class="nb">degree</span><span class="o">!=</span><span class="s">&#39;bs&#39;</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="8%" />
<col width="52%" />
<col width="8%" />
<col width="16%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">school_code</th>
<th class="head">code</th>
<th class="head">title</th>
<th class="head">degree</th>
<th class="head">part_of_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">bus</td>
<td class="htsql-text-type">gecon</td>
<td class="htsql-text-type">Master of Arts in Economics</td>
<td class="htsql-text-type">ma</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">bus</td>
<td class="htsql-text-type">pacc</td>
<td class="htsql-text-type">Graduate Certificate in Accounting</td>
<td class="htsql-text-type">ct</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-even"><td class="htsql-text-type">bus</td>
<td class="htsql-text-type">pbusad</td>
<td class="htsql-text-type">Certificate in Business Administration</td>
<td class="htsql-text-type">ct</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Filters can be combined with selectors and links.  The following request
returns courses, listing only department number and title, having less
than 3 credits in the &#8220;School of Natural Science&#8221;:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course{department_code,%20no,%20title}%20?credits&lt;3&amp;department.school.code='ns'" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course{department_code,%20no,%20title}%20?credits&lt;3&amp;department.school.code='ns'" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="p">{</span><span class="nb">department_code</span><span class="p">,</span> <span class="nb">no</span><span class="p">,</span> <span class="nb">title</span><span class="p">}</span> <span class="o">?</span><span class="nb">credits</span><span class="o">&lt;</span><span class="m">3</span><span class="o">&amp;</span><span class="nb">department</span><span class="p">.</span><span class="nb">school</span><span class="p">.</span><span class="nb">code</span><span class="o">=</span><span class="s">&#39;ns&#39;</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="7%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">title</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">astro</td>
<td class="htsql-integer-type">106</td>
<td class="htsql-text-type">General Astronomy I Lab</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">astro</td>
<td class="htsql-integer-type">211</td>
<td class="htsql-text-type">General Astronomy II Lab</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">astro</td>
<td class="htsql-integer-type">241</td>
<td class="htsql-text-type">Telescope Workshop</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">astro</td>
<td class="htsql-integer-type">329</td>
<td class="htsql-text-type">Radio Astronomy Lab</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="sorting-truncating">
<h3>Sorting &amp; Truncating<a class="headerlink" href="#sorting-truncating" title="Permalink to this headline">¶</a></h3>
<p>By default, with a simple table expression such as <tt class="docutils literal"><span class="pre">/school</span></tt>, all rows
are returned in the order of the primary key columns.  To override the
sort order, you can use <tt class="docutils literal"><span class="pre">sort()</span></tt> function:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school.sort(name)" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school.sort(name)" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="p">.</span><span class="nf">sort</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="74%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">campus</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">edu</td>
<td class="htsql-text-type">College of Education</td>
<td class="htsql-text-type">old</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">ph</td>
<td class="htsql-text-type">Public Honorariums</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-even"><td class="htsql-text-type">art</td>
<td class="htsql-text-type">School of Art &amp; Design</td>
<td class="htsql-text-type">old</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">la</td>
<td class="htsql-text-type">School of Arts and Humanities</td>
<td class="htsql-text-type">old</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Sort direction can be specified explicitly using <tt class="docutils literal"><span class="pre">+</span></tt> for ascending and
<tt class="docutils literal"><span class="pre">-</span></tt> for descending order.  Also, you can sort by multiple columns. The
following example sorts courses in ascending order by department and
then in descending order by number of credits:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course.sort(department_code%2B,%20credits-)" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course.sort(department_code%2B,%20credits-)" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="p">.</span><span class="nf">sort</span><span class="p">(</span><span class="nb">department_code</span><span class="o">+</span><span class="p">,</span> <span class="nb">credits</span><span class="o">-</span><span class="p">)</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="2%" />
<col width="13%" />
<col width="4%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">title</th>
<th class="head">credits</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">620</td>
<td class="htsql-text-type">Accounting Internship</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-text-type">Supervised internship in a business or nonprofit organization on an accounting position.</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">315</td>
<td class="htsql-text-type">Financial Accounting</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-text-type">Integration of the conceptual and computational aspects of asset, liability and stockholders equity accounting.</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>When sorting by a selected output column, you could use a shortcut
syntax which combines column selection and sorting:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course{department_code%2B,%20no,%20credits-,%20title}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course{department_code%2B,%20no,%20credits-,%20title}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="p">{</span><span class="nb">department_code</span><span class="o">+</span><span class="p">,</span> <span class="nb">no</span><span class="p">,</span> <span class="nb">credits</span><span class="o">-</span><span class="p">,</span> <span class="nb">title</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="6%" />
<col width="14%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">credits</th>
<th class="head">title</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">620</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-text-type">Accounting Internship</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">315</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-text-type">Financial Accounting</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">511</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-text-type">Audit</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">200</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-text-type">Introduction to Accounting</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>To list a range of rows, the <tt class="docutils literal"><span class="pre">limit()</span></tt> function takes one or two
arguments.  The first argument is the number of rows to return, the
optional second argument is the starting offset.  The next example
returns 5 records from the program table, skipping first 10 rows:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program.limit(5,10)" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program.limit(5,10)" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">program</span><span class="p">.</span><span class="nf">limit</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">10</span><span class="p">)</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="8%" />
<col width="51%" />
<col width="8%" />
<col width="17%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">school_code</th>
<th class="head">code</th>
<th class="head">title</th>
<th class="head">degree</th>
<th class="head">part_of_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">edu</td>
<td class="htsql-text-type">gedu</td>
<td class="htsql-text-type">M.S. in Education</td>
<td class="htsql-text-type">ms</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">edu</td>
<td class="htsql-text-type">glited</td>
<td class="htsql-text-type">Master of Arts in Literacy Education</td>
<td class="htsql-text-type">ma</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-even"><td class="htsql-text-type">edu</td>
<td class="htsql-text-type">gtch</td>
<td class="htsql-text-type">Master of Arts in Teaching</td>
<td class="htsql-text-type">ma</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">edu</td>
<td class="htsql-text-type">psci</td>
<td class="htsql-text-type">Certificate in Science Teaching</td>
<td class="htsql-text-type">ct</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-even"><td class="htsql-text-type">edu</td>
<td class="htsql-text-type">umath</td>
<td class="htsql-text-type">Bachelor of Arts in Math Education</td>
<td class="htsql-text-type">ba</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="formatting-output">
<h3>Formatting Output<a class="headerlink" href="#formatting-output" title="Permalink to this headline">¶</a></h3>
<p>By default, HTSQL tries to guess the desired output format depending
upon the browser or the tool used to make the request.  This can be
overridden with a format decorator, such as <tt class="docutils literal"><span class="pre">/:json</span></tt>.  For example,
results in JSON format can be requested as follows:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school/:json" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school/:json" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="o">/</span><span class="p">:</span><span class="nf">json</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<div class="highlight-text"><div class="highlight"><pre>{
  &quot;school&quot;: [
    {
      &quot;code&quot;: &quot;art&quot;,
      &quot;name&quot;: &quot;School of Art &amp; Design&quot;,
      &quot;campus&quot;: &quot;old&quot;
    },
    {
      &quot;code&quot;: &quot;bus&quot;,
      &quot;name&quot;: &quot;School of Business&quot;,
      &quot;campus&quot;: &quot;south&quot;
    },
    {
      &quot;code&quot;: &quot;edu&quot;,
      &quot;name&quot;: &quot;College of Education&quot;,
      &quot;campus&quot;: &quot;old&quot;
    },
    {
      &quot;code&quot;: &quot;eng&quot;,
      &quot;name&quot;: &quot;School of Engineering&quot;,
      &quot;campus&quot;: &quot;north&quot;
    },
    {
      &quot;code&quot;: &quot;la&quot;,
      &quot;name&quot;: &quot;School of Arts and Humanities&quot;,
      &quot;campus&quot;: &quot;old&quot;
    },
    {
      &quot;code&quot;: &quot;mus&quot;,
      &quot;name&quot;: &quot;School of Music &amp; Dance&quot;,
      &quot;campus&quot;: &quot;south&quot;
    },
    {
      &quot;code&quot;: &quot;ns&quot;,
      &quot;name&quot;: &quot;School of Natural Sciences&quot;,
      &quot;campus&quot;: &quot;old&quot;
    },
    {
      &quot;code&quot;: &quot;ph&quot;,
      &quot;name&quot;: &quot;Public Honorariums&quot;
    },
    {
      &quot;code&quot;: &quot;sc&quot;,
      &quot;name&quot;: &quot;School of Continuing Studies&quot;
    }
  ]
}
</pre></div>
</div>
</div>
</div>
<p>Other formats include <tt class="docutils literal"><span class="pre">/:txt</span></tt> for plain-text formatting, <tt class="docutils literal"><span class="pre">/:html</span></tt>
for display in web browsers, and <tt class="docutils literal"><span class="pre">/:csv</span></tt> for data exchange.</p>
</div>
<div class="section" id="putting-it-together">
<h3>Putting it Together<a class="headerlink" href="#putting-it-together" title="Permalink to this headline">¶</a></h3>
<p>HTSQL is a composable language where individual query fragments can be
combined into more complex expressions.  For example, a selection on the
course table such as <tt class="docutils literal"><span class="pre">/course{department,</span> <span class="pre">no,</span> <span class="pre">title}</span></tt> and a filter on
the course table, <tt class="docutils literal"><span class="pre">/course?credits&lt;3</span></tt> can be combined in either of the
following two forms:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course{department_code,%20no,%20title}?credits&lt;3" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course{department_code,%20no,%20title}?credits&lt;3" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="p">{</span><span class="nb">department_code</span><span class="p">,</span> <span class="nb">no</span><span class="p">,</span> <span class="nb">title</span><span class="p">}</span><span class="o">?</span><span class="nb">credits</span><span class="o">&lt;</span><span class="m">3</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="7%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">title</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">100</td>
<td class="htsql-text-type">Practical Bookkeeping</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">astro</td>
<td class="htsql-integer-type">106</td>
<td class="htsql-text-type">General Astronomy I Lab</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">astro</td>
<td class="htsql-integer-type">211</td>
<td class="htsql-text-type">General Astronomy II Lab</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course?credits&lt;3%20{department_code,%20no,%20title}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course?credits&lt;3%20{department_code,%20no,%20title}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="o">?</span><span class="nb">credits</span><span class="o">&lt;</span><span class="m">3</span> <span class="p">{</span><span class="nb">department_code</span><span class="p">,</span> <span class="nb">no</span><span class="p">,</span> <span class="nb">title</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="7%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">title</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">100</td>
<td class="htsql-text-type">Practical Bookkeeping</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">astro</td>
<td class="htsql-integer-type">106</td>
<td class="htsql-text-type">General Astronomy I Lab</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">astro</td>
<td class="htsql-integer-type">211</td>
<td class="htsql-text-type">General Astronomy II Lab</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note that the order in which selection and filter operators are applied
doesn&#8217;t affect the output. You could also use a functional form:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course.filter(credits&lt;3).select(department_code,%20no,%20title)" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course.filter(credits&lt;3).select(department_code,%20no,%20title)" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="p">.</span><span class="nf">filter</span><span class="p">(</span><span class="nb">credits</span><span class="o">&lt;</span><span class="m">3</span><span class="p">).</span><span class="nf">select</span><span class="p">(</span><span class="nb">department_code</span><span class="p">,</span> <span class="nb">no</span><span class="p">,</span> <span class="nb">title</span><span class="p">)</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
<p>For the following two equivalent examples, we combine 3 operators &#8211;
sorting, truncating, and selection:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course.sort(credits-).limit(10){department_code,%20no,%20credits}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course.sort(credits-).limit(10){department_code,%20no,%20credits}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="p">.</span><span class="nf">sort</span><span class="p">(</span><span class="nb">credits</span><span class="o">-</span><span class="p">).</span><span class="nf">limit</span><span class="p">(</span><span class="m">10</span><span class="p">){</span><span class="nb">department_code</span><span class="p">,</span> <span class="nb">no</span><span class="p">,</span> <span class="nb">credits</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="60%" />
<col width="12%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">credits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">be</td>
<td class="htsql-integer-type">415</td>
<td class="htsql-integer-type">8</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">620</td>
<td class="htsql-integer-type">6</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">arthis</td>
<td class="htsql-integer-type">209</td>
<td class="htsql-integer-type">6</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course{department_code,%20no,%20credits-}.limit(10)" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course{department_code,%20no,%20credits-}.limit(10)" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="p">{</span><span class="nb">department_code</span><span class="p">,</span> <span class="nb">no</span><span class="p">,</span> <span class="nb">credits</span><span class="o">-</span><span class="p">}.</span><span class="nf">limit</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="60%" />
<col width="12%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">credits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">be</td>
<td class="htsql-integer-type">415</td>
<td class="htsql-integer-type">8</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">620</td>
<td class="htsql-integer-type">6</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">arthis</td>
<td class="htsql-integer-type">209</td>
<td class="htsql-integer-type">6</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The relative position of sort and limit matter, switching the positions
will change the output:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course.limit(10).sort(credits-){department_code,%20no,%20credits}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course.limit(10).sort(credits-){department_code,%20no,%20credits}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="p">.</span><span class="nf">limit</span><span class="p">(</span><span class="m">10</span><span class="p">).</span><span class="nf">sort</span><span class="p">(</span><span class="nb">credits</span><span class="o">-</span><span class="p">){</span><span class="nb">department_code</span><span class="p">,</span> <span class="nb">no</span><span class="p">,</span> <span class="nb">credits</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="60%" />
<col width="12%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">credits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">315</td>
<td class="htsql-integer-type">5</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">511</td>
<td class="htsql-integer-type">5</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">200</td>
<td class="htsql-integer-type">3</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The following example requests the top 5 departments from schools with
<tt class="docutils literal"><span class="pre">'art'</span></tt> in their name, sorted in descending order by the number of
courses.  The output columns include the corresponding school name, the
name of the department itself, and the number of courses.  The output
format is &#8220;Comma-Separated Values&#8221; suitable for consumption by
spreadsheet or statistical analysis packages:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department{school.name,%20name,%20count(course)-}%0A%20%20%20%20%20%20%20%20%20%20%20.filter(school.name~'art').limit(5)/:csv" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department{school.name,%20name,%20count(course)-}%0A%20%20%20%20%20%20%20%20%20%20%20.filter(school.name~'art').limit(5)/:csv" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">{</span><span class="nb">school</span><span class="p">.</span><span class="nb">name</span><span class="p">,</span> <span class="nb">name</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nb">course</span><span class="p">)</span><span class="o">-</span><span class="p">}</span>
           <span class="p">.</span><span class="nf">filter</span><span class="p">(</span><span class="nb">school</span><span class="p">.</span><span class="nb">name</span><span class="o">~</span><span class="s">&#39;art&#39;</span><span class="p">).</span><span class="nf">limit</span><span class="p">(</span><span class="m">5</span><span class="p">)</span><span class="o">/</span><span class="p">:</span><span class="nf">csv</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<div class="highlight-text"><div class="highlight"><pre>name,name,count(course)
School of Arts and Humanities,English,21
School of Arts and Humanities,Foreign Languages,21
School of Arts and Humanities,Art History,20
School of Arts and Humanities,Political Science,19
School of Art &amp; Design,Studio Art,19
</pre></div>
</div>
</div>
</div>
<p>HTSQL requests are powerful without being complex.  They are easy to
read and modify.  They adapt to changes in the database.  These
qualities increase the usability of databases by all types of users and
reduce the likelihood of costly errors.</p>
</div>
</div>
<div class="section" id="relating-and-aggregating-data">
<h2><a class="toc-backref" href="#id2">Relating and Aggregating Data</a><a class="headerlink" href="#relating-and-aggregating-data" title="Permalink to this headline">¶</a></h2>
<p>HTSQL distinguishes between <em>singular</em> and <em>plural</em> relationships to
simplify query construction.  By a <em>singular</em> relationship we mean for
every record in one table, there is at most one record in a linked
table; by <em>plural</em> we mean there is perhaps more than one correlated
record.  To select a <em>plural</em> expression in a result set, an <em>aggregate</em>
function, such as <tt class="docutils literal"><span class="pre">sum</span></tt>, <tt class="docutils literal"><span class="pre">count</span></tt>, or <tt class="docutils literal"><span class="pre">exists</span></tt> must be used.  In
this way, what would be many values are converted into a single data cell
and integrated into a coherent result set.</p>
<p>By requiring aggregates for plural expressions, HTSQL reduces query
construction time and reduces errors.  When a query starts with a table,
rows returned are directly correlated to records in this table. Since
cross products or projections cannot be created accidentally, the
combined result set is always consistent and understandable.</p>
<div class="section" id="basic-linking">
<h3>Basic Linking<a class="headerlink" href="#basic-linking" title="Permalink to this headline">¶</a></h3>
<p>One-to-many relationships are the primary building block of relational
structures.  In our schema, each <tt class="docutils literal"><span class="pre">course</span></tt> is offered by a
<tt class="docutils literal"><span class="pre">department</span></tt> with a mandatory foreign key.  For each course, there is
exactly one corresponding department.  In this case, the relationship is
singular in one direction and plural in the other.</p>
<p>If each row in your result set represents a <tt class="docutils literal"><span class="pre">course</span></tt>, it is easy to
get correlated information for each course&#8217;s department:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course{department.name,%20title}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course{department.name,%20title}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="p">{</span><span class="nb">department</span><span class="p">.</span><span class="nb">name</span><span class="p">,</span> <span class="nb">title</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">title</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">Accounting</td>
<td class="htsql-text-type">Practical Bookkeeping</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">Accounting</td>
<td class="htsql-text-type">Introduction to Accounting</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">Accounting</td>
<td class="htsql-text-type">Accounting Information Systems</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>It&#8217;s possible to join <em>up</em> a hierarchy in this way, but not down. If
each row in your result set is a <tt class="docutils literal"><span class="pre">department</span></tt>, then it is an error to
request <tt class="docutils literal"><span class="pre">course</span></tt>&#8216;s <tt class="docutils literal"><span class="pre">credits</span></tt> since there could be many courses in a
given department:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department{name,%20course.credits}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department{name,%20course.credits}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nb">course</span><span class="p">.</span><span class="nb">credits</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<div class="highlight-text"><div class="highlight"><pre>Expected a singular expression
While translating:
    /department{name, course.credits}
                             ^^^^^^^
</pre></div>
</div>
</div>
</div>
<p>In cases like this, an aggregate function, such as <tt class="docutils literal"><span class="pre">max</span></tt> is needed to
convert a plural expression into a singular value.  The following
example shows the maximum course credits by department:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department{name,%20max(course.credits)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department{name,%20max(course.credits)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">max</span><span class="p">(</span><span class="nb">course</span><span class="p">.</span><span class="nb">credits</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">max(course.credits)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">Accounting</td>
<td class="htsql-integer-type">6</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">Art History</td>
<td class="htsql-integer-type">6</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">Astronomy</td>
<td class="htsql-integer-type">5</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Conversely, you cannot use aggregates with singular expressions.  For
example, since <tt class="docutils literal"><span class="pre">school</span></tt> is singular relative to <tt class="docutils literal"><span class="pre">department</span></tt>, it is
an error to count them:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department{name,%20count(school)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department{name,%20count(school)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nb">school</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<div class="highlight-text"><div class="highlight"><pre>Expected a plural operand
While translating:
    /department{name, count(school)}
                      ^^^^^^^^^^^^^
</pre></div>
</div>
</div>
</div>
<p>For single row or <em>scalar</em> expressions, an aggregate is always needed
when referencing a table.  For example, the query below returns maximum
number of course credits across all departments:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/max(course.credits)" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/max(course.credits)" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nf">max</span><span class="p">(</span><span class="nb">course</span><span class="p">.</span><span class="nb">credits</span><span class="p">)</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
</thead>
<tbody valign="top">
<tr class="row-odd"><td class="htsql-integer-type">8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="aggregate-expressions">
<h3>Aggregate Expressions<a class="headerlink" href="#aggregate-expressions" title="Permalink to this headline">¶</a></h3>
<p>Since <tt class="docutils literal"><span class="pre">school</span></tt> table has a <em>plural</em> (one to many) relationship
with <tt class="docutils literal"><span class="pre">program</span></tt> and <tt class="docutils literal"><span class="pre">department</span></tt>, we can count them:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school{name,%20count(program),%20count(department)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school{name,%20count(program),%20count(department)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nb">program</span><span class="p">),</span> <span class="nf">count</span><span class="p">(</span><span class="nb">department</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="26%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">count(program)</th>
<th class="head">count(department)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">School of Art &amp; Design</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-integer-type">1</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">School of Business</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-integer-type">3</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">College of Education</td>
<td class="htsql-integer-type">7</td>
<td class="htsql-integer-type">2</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">School of Engineering</td>
<td class="htsql-integer-type">8</td>
<td class="htsql-integer-type">4</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Filters may be used within an aggregate expression.  For example, the
following returns the number of courses, by department, that are at
the 400 level or above:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department{name,%20count(course?no&gt;=400)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department{name,%20count(course?no&gt;=400)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">400</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">count(course?no&gt;=400)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">Accounting</td>
<td class="htsql-integer-type">7</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">Art History</td>
<td class="htsql-integer-type">9</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">Astronomy</td>
<td class="htsql-integer-type">5</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">Bioengineering</td>
<td class="htsql-integer-type">3</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>It&#8217;s possible to nest aggregate expressions.  This request returns the
average number of courses each department offers:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school{name,%20avg(department.count(course))}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school{name,%20avg(department.count(course))}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">avg</span><span class="p">(</span><span class="nb">department</span><span class="p">.</span><span class="nf">count</span><span class="p">(</span><span class="nb">course</span><span class="p">))}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">avg(department.count(course))</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">School of Art &amp; Design</td>
<td class="htsql-decimal-type">19.0</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">School of Business</td>
<td class="htsql-decimal-type">14.6666666667</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">College of Education</td>
<td class="htsql-decimal-type">17.5</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-decimal-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Filters and nested aggregates can be combined.  Here we count, for each
school, departments offering 4 or more credits:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school{name,%20count(department?exists(course?credits&gt;3))}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school{name,%20count(department?exists(course?credits&gt;3))}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nb">department</span><span class="o">?</span><span class="nf">exists</span><span class="p">(</span><span class="nb">course</span><span class="o">?</span><span class="nb">credits</span><span class="o">&gt;</span><span class="m">3</span><span class="p">))}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="66%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">count(department?exists(course?credits&gt;3))</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">School of Art &amp; Design</td>
<td class="htsql-integer-type">1</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">School of Business</td>
<td class="htsql-integer-type">3</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">College of Education</td>
<td class="htsql-integer-type">1</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Filtering can be done on one column, with aggregation on another.  This
example shows average credits from only high-level courses:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department{name,%20avg((course?no&gt;400).credits)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department{name,%20avg((course?no&gt;400).credits)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">avg</span><span class="p">((</span><span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;</span><span class="m">400</span><span class="p">).</span><span class="nb">credits</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">avg((course?no&gt;400).credits)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">Accounting</td>
<td class="htsql-decimal-type">3.71428571429</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">Art History</td>
<td class="htsql-decimal-type">3.55555555556</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">Astronomy</td>
<td class="htsql-decimal-type">2.8</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">Bioengineering</td>
<td class="htsql-decimal-type">4.33333333333</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-decimal-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Numerical aggregates are supported.  These requests compute some useful
<tt class="docutils literal"><span class="pre">course.credit</span></tt> statistics:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department{code,%20min(course.credits),%20max(course.credits)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department{code,%20min(course.credits),%20max(course.credits)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">{</span><span class="nb">code</span><span class="p">,</span> <span class="nf">min</span><span class="p">(</span><span class="nb">course</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span> <span class="nf">max</span><span class="p">(</span><span class="nb">course</span><span class="p">.</span><span class="nb">credits</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="43%" />
<col width="43%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">min(course.credits)</th>
<th class="head">max(course.credits)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-integer-type">6</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">arthis</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-integer-type">6</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">astro</td>
<td class="htsql-integer-type">1</td>
<td class="htsql-integer-type">5</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">be</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-integer-type">8</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department{code,%20sum(course.credits),%20avg(course.credits)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department{code,%20sum(course.credits),%20avg(course.credits)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">{</span><span class="nb">code</span><span class="p">,</span> <span class="nf">sum</span><span class="p">(</span><span class="nb">course</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span> <span class="nf">avg</span><span class="p">(</span><span class="nb">course</span><span class="p">.</span><span class="nb">credits</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="43%" />
<col width="43%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">sum(course.credits)</th>
<th class="head">avg(course.credits)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">42</td>
<td class="htsql-decimal-type">3.5</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">arthis</td>
<td class="htsql-integer-type">70</td>
<td class="htsql-decimal-type">3.5</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">astro</td>
<td class="htsql-integer-type">66</td>
<td class="htsql-decimal-type">3.0</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">be</td>
<td class="htsql-integer-type">55</td>
<td class="htsql-decimal-type">3.23529411765</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-decimal-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <tt class="docutils literal"><span class="pre">every</span></tt> aggregate tests that a predicate is true for every row in
the correlated set.  This example returns <tt class="docutils literal"><span class="pre">department</span></tt> records that
either lack correlated <tt class="docutils literal"><span class="pre">course</span></tt> records or where every one of those
<tt class="docutils literal"><span class="pre">course</span></tt> records have exactly <tt class="docutils literal"><span class="pre">3</span></tt> credits:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department{name,%20avg(course.credits)}%20?every(course.credits=3)" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department{name,%20avg(course.credits)}%20?every(course.credits=3)" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">avg</span><span class="p">(</span><span class="nb">course</span><span class="p">.</span><span class="nb">credits</span><span class="p">)}</span> <span class="o">?</span><span class="nf">every</span><span class="p">(</span><span class="nb">course</span><span class="p">.</span><span class="nb">credits</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="49%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">avg(course.credits)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">Bursar&#8217;s Office</td>
<td class="htsql-decimal-type htsql-null-val"></td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">Career Development</td>
<td class="htsql-decimal-type htsql-null-val"></td>
</tr>
<tr class="row-even"><td class="htsql-text-type">Educational Policy</td>
<td class="htsql-decimal-type">3.0</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-decimal-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="arbitrary-linking">
<h3>Arbitrary Linking<a class="headerlink" href="#arbitrary-linking" title="Permalink to this headline">¶</a></h3>
<p>The unlink operator (<tt class="docutils literal"><span class="pre">&#64;</span></tt>) permits arbitrary, non-relative links; it
relates the current entity with all other records of another table.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school?count(department)&gt;avg(@school.count(department))" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school?count(department)&gt;avg(@school.count(department))" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="o">?</span><span class="nf">count</span><span class="p">(</span><span class="nb">department</span><span class="p">)</span><span class="o">&gt;</span><span class="nf">avg</span><span class="p">(@</span><span class="nb">school</span><span class="p">.</span><span class="nf">count</span><span class="p">(</span><span class="nb">department</span><span class="p">))</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="74%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">campus</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">bus</td>
<td class="htsql-text-type">School of Business</td>
<td class="htsql-text-type">south</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">eng</td>
<td class="htsql-text-type">School of Engineering</td>
<td class="htsql-text-type">north</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">la</td>
<td class="htsql-text-type">School of Arts and Humanities</td>
<td class="htsql-text-type">old</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The query above returns schools that have above average number of
departments.  This could also be written with the link function
<tt class="docutils literal"><span class="pre">fork()</span></tt> which generates the current graph node to itself:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school?count(department)&gt;avg(fork().count(department))" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school?count(department)&gt;avg(fork().count(department))" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="o">?</span><span class="nf">count</span><span class="p">(</span><span class="nb">department</span><span class="p">)</span><span class="o">&gt;</span><span class="nf">avg</span><span class="p">(</span><span class="nf">fork</span><span class="p">().</span><span class="nf">count</span><span class="p">(</span><span class="nb">department</span><span class="p">))</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="74%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">campus</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">bus</td>
<td class="htsql-text-type">School of Business</td>
<td class="htsql-text-type">south</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">eng</td>
<td class="htsql-text-type">School of Engineering</td>
<td class="htsql-text-type">north</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">la</td>
<td class="htsql-text-type">School of Arts and Humanities</td>
<td class="htsql-text-type">old</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="compositional-navigation">
<h3>Compositional Navigation<a class="headerlink" href="#compositional-navigation" title="Permalink to this headline">¶</a></h3>
<p>Suppose you have an HTSQL query that returns the school of engineering.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school.filter(code='eng')" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school.filter(code='eng')" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="p">.</span><span class="nf">filter</span><span class="p">(</span><span class="nb">code</span><span class="o">=</span><span class="s">&#39;eng&#39;</span><span class="p">)</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
<p>Now you&#8217;d like to return departments associated with this school.  This
could be written as:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department?school.code='eng'" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department?school.code='eng'" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="o">?</span><span class="nb">school</span><span class="p">.</span><span class="nb">code</span><span class="o">=</span><span class="s">&#39;eng&#39;</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="59%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">be</td>
<td class="htsql-text-type">Bioengineering</td>
<td class="htsql-text-type">eng</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">comp</td>
<td class="htsql-text-type">Computer Science</td>
<td class="htsql-text-type">eng</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">ee</td>
<td class="htsql-text-type">Electrical Engineering</td>
<td class="htsql-text-type">eng</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">me</td>
<td class="htsql-text-type">Mechanical Engineering</td>
<td class="htsql-text-type">eng</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>However, if you want to re-use the existing (and working!) query
fragment, <tt class="docutils literal"><span class="pre">school.filter(code='eng')</span></tt>, you could write:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school.filter(code='eng').department" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school.filter(code='eng').department" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="p">.</span><span class="nf">filter</span><span class="p">(</span><span class="nb">code</span><span class="o">=</span><span class="s">&#39;eng&#39;</span><span class="p">).</span><span class="nb">department</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="59%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">be</td>
<td class="htsql-text-type">Bioengineering</td>
<td class="htsql-text-type">eng</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">comp</td>
<td class="htsql-text-type">Computer Science</td>
<td class="htsql-text-type">eng</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">ee</td>
<td class="htsql-text-type">Electrical Engineering</td>
<td class="htsql-text-type">eng</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">me</td>
<td class="htsql-text-type">Mechanical Engineering</td>
<td class="htsql-text-type">eng</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Continuing this chain, you may choose the Department of Electrical
Engineering and then list associated courses.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school.filter(code='eng')%0A.department.filter(code='ee')%0A.course" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school.filter(code='eng')%0A.department.filter(code='ee')%0A.course" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="p">.</span><span class="nf">filter</span><span class="p">(</span><span class="nb">code</span><span class="o">=</span><span class="s">&#39;eng&#39;</span><span class="p">)</span>
<span class="p">.</span><span class="nb">department</span><span class="p">.</span><span class="nf">filter</span><span class="p">(</span><span class="nb">code</span><span class="o">=</span><span class="s">&#39;ee&#39;</span><span class="p">)</span>
<span class="p">.</span><span class="nb">course</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="1%" />
<col width="15%" />
<col width="3%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">title</th>
<th class="head">credits</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">ee</td>
<td class="htsql-integer-type">107</td>
<td class="htsql-text-type">Exploration of Electrical Engineering</td>
<td class="htsql-integer-type">4</td>
<td class="htsql-text-type">Exploration of electrical engineering through several hands-on activities that cover a broad spectrum of applications and fundamental concepts. </td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">ee</td>
<td class="htsql-integer-type">202</td>
<td class="htsql-text-type">Engineering Electromagnetics</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-text-type">Static electric and magnetic fields; solutions to static field problems, electromagnetic waves, boundary conditions, engineering applications.</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">ee</td>
<td class="htsql-integer-type">220</td>
<td class="htsql-text-type">Semiconductor Devices</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-text-type">Theory of semiconductor devices, principles of design and fabrication, p-n junctions, bipolar transistors, their structure, operation modes and application, MOS capacitors and MOSFETs.</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">ee</td>
<td class="htsql-integer-type">221</td>
<td class="htsql-text-type">Semiconductor Devices Lab</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-text-type">Provides practical examination of semiconductor devices properties.</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Drill-down navigation trims unrelated rows and preserves the order of
prior links. Consider the following two queries.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="45%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-text-type">Accounting</td>
<td class="htsql-text-type">bus</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">arthis</td>
<td class="htsql-text-type">Art History</td>
<td class="htsql-text-type">la</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">astro</td>
<td class="htsql-text-type">Astronomy</td>
<td class="htsql-text-type">ns</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">be</td>
<td class="htsql-text-type">Bioengineering</td>
<td class="htsql-text-type">eng</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school.department" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school.department" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="p">.</span><span class="nb">department</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">stdart</td>
<td class="htsql-text-type">Studio Art</td>
<td class="htsql-text-type">art</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">acc</td>
<td class="htsql-text-type">Accounting</td>
<td class="htsql-text-type">bus</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">econ</td>
<td class="htsql-text-type">Economics</td>
<td class="htsql-text-type">bus</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">mm</td>
<td class="htsql-text-type">Management &amp; Marketing</td>
<td class="htsql-text-type">bus</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Although the latter query also returns records from the department
table, it differs from the former in two ways.  First, it skips
departments lacking an associated school.  Second, it orders the result
first by school code and then on department code.</p>
</div>
</div>
<div class="section" id="calculations-references">
<h2><a class="toc-backref" href="#id3">Calculations &amp; References</a><a class="headerlink" href="#calculations-references" title="Permalink to this headline">¶</a></h2>
<div class="section" id="calculated-attributes">
<h3>Calculated Attributes<a class="headerlink" href="#calculated-attributes" title="Permalink to this headline">¶</a></h3>
<p>Suppose that you&#8217;re returning schools along with the number of
associated departments, and we want to list only schools with
more than 3 departments.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school{name,%20count(department)}?%20count(department)&gt;3" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school{name,%20count(department)}?%20count(department)&gt;3" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nb">department</span><span class="p">)}</span><span class="o">?</span> <span class="nf">count</span><span class="p">(</span><span class="nb">department</span><span class="p">)</span><span class="o">&gt;</span><span class="m">3</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="63%" />
<col width="37%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">count(department)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">School of Engineering</td>
<td class="htsql-integer-type">4</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">School of Arts and Humanities</td>
<td class="htsql-integer-type">6</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">School of Music &amp; Dance</td>
<td class="htsql-integer-type">4</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In this query we have to repeat the expression <tt class="docutils literal"><span class="pre">count(department)</span></tt>
twice; once to select the value for output, and the other as part of
filter criteria.  It is possible to avoid this duplication by defining a
calculated attribute <tt class="docutils literal"><span class="pre">num_dept</span></tt>.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school.define(num_dept:=count(department))%0A%20%20{name,%20num_dept}?%20num_dept&gt;3" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school.define(num_dept:=count(department))%0A%20%20{name,%20num_dept}?%20num_dept&gt;3" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="nb">num_dept</span><span class="p">:=</span><span class="nf">count</span><span class="p">(</span><span class="nb">department</span><span class="p">))</span>
  <span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nb">num_dept</span><span class="p">}</span><span class="o">?</span> <span class="nb">num_dept</span><span class="o">&gt;</span><span class="m">3</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
<p>As syntax sugar, you could combine definition and selection.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school{name,%20num_dept:=count(department)}?%20num_dept&gt;3" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school{name,%20num_dept:=count(department)}?%20num_dept&gt;3" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nb">num_dept</span><span class="p">:=</span><span class="nf">count</span><span class="p">(</span><span class="nb">department</span><span class="p">)}</span><span class="o">?</span> <span class="nb">num_dept</span><span class="o">&gt;</span><span class="m">3</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
<p>All three of these examples return the same result.</p>
</div>
<div class="section" id="calculated-links">
<h3>Calculated Links<a class="headerlink" href="#calculated-links" title="Permalink to this headline">¶</a></h3>
<p>In the prior example <tt class="docutils literal"><span class="pre">num_dept</span></tt> was a scalar value with respect to each
school.  It&#8217;s possible to define links as well.  Suppose we&#8217;d like to
calculate a set of statistics by department on 200 level courses typically
taken by sophomores.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department{name,%20count(course?no&gt;=200&amp;no&lt;300),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max((course?no&gt;=200&amp;no&lt;300).credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min((course?no&gt;=200&amp;no&lt;300).credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg((course?no&gt;=200&amp;no&lt;300).credits)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department{name,%20count(course?no&gt;=200&amp;no&lt;300),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max((course?no&gt;=200&amp;no&lt;300).credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min((course?no&gt;=200&amp;no&lt;300).credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg((course?no&gt;=200&amp;no&lt;300).credits)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">200</span><span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="m">300</span><span class="p">),</span>
                  <span class="nf">max</span><span class="p">((</span><span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">200</span><span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="m">300</span><span class="p">).</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">min</span><span class="p">((</span><span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">200</span><span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="m">300</span><span class="p">).</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">avg</span><span class="p">((</span><span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">200</span><span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="m">300</span><span class="p">).</span><span class="nb">credits</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="19%" />
<col width="24%" />
<col width="24%" />
<col width="24%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">count(course?no&gt;=200&amp;no&lt;300)</th>
<th class="head">max((course?no&gt;=200&amp;no&lt;300).credits)</th>
<th class="head">min((course?no&gt;=200&amp;no&lt;300).credits)</th>
<th class="head">avg((course?no&gt;=200&amp;no&lt;300).credits)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">Accounting</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-decimal-type">3.0</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">Art History</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-decimal-type">3.8</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">Astronomy</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-integer-type">1</td>
<td class="htsql-decimal-type">3.0</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-decimal-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here the link expression <tt class="docutils literal"><span class="pre">(course?no&gt;=200&amp;no&lt;300)</span></tt> is duplicated.  We can
define a <tt class="docutils literal"><span class="pre">sophomore</span></tt> link to these courses as follows.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department.define(sophomore%20:=%20course?no&gt;=200&amp;no&lt;300)%0A%20%20%20%20%20%20%20%20%20%20%20{name,%20count(sophomore),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(sophomore.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(sophomore.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(sophomore.credits)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department.define(sophomore%20:=%20course?no&gt;=200&amp;no&lt;300)%0A%20%20%20%20%20%20%20%20%20%20%20{name,%20count(sophomore),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(sophomore.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(sophomore.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(sophomore.credits)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="nb">sophomore</span> <span class="p">:=</span> <span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">200</span><span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="m">300</span><span class="p">)</span>
           <span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nb">sophomore</span><span class="p">),</span>
                  <span class="nf">max</span><span class="p">(</span><span class="nb">sophomore</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">min</span><span class="p">(</span><span class="nb">sophomore</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">avg</span><span class="p">(</span><span class="nb">sophomore</span><span class="p">.</span><span class="nb">credits</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
<p>For readability, it is helpful to put definitions at the end of an
expression where it is used.  In the following example the usage of
<tt class="docutils literal"><span class="pre">sophomore</span></tt> precedes its definition.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department{name,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20{count(sophomore),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(sophomore.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(sophomore.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(sophomore.credits)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20}%20:where(sophomore%20:=%20course?no&gt;=200&amp;no&lt;300)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department{name,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20{count(sophomore),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(sophomore.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(sophomore.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(sophomore.credits)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20}%20:where(sophomore%20:=%20course?no&gt;=200&amp;no&lt;300)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span>
             <span class="p">{</span><span class="nf">count</span><span class="p">(</span><span class="nb">sophomore</span><span class="p">),</span>
              <span class="nf">max</span><span class="p">(</span><span class="nb">sophomore</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
              <span class="nf">min</span><span class="p">(</span><span class="nb">sophomore</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
              <span class="nf">avg</span><span class="p">(</span><span class="nb">sophomore</span><span class="p">.</span><span class="nb">credits</span><span class="p">)</span>
             <span class="p">}</span> <span class="p">:</span><span class="nf">where</span><span class="p">(</span><span class="nb">sophomore</span> <span class="p">:=</span> <span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">200</span><span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="m">300</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
<p>In this example we use infix notation to call the <tt class="docutils literal"><span class="pre">where()</span></tt> function.
Generally, any function call <tt class="docutils literal"><span class="pre">f(x,y)</span></tt> could be written <tt class="docutils literal"><span class="pre">x</span> <span class="pre">:f</span> <span class="pre">y</span></tt>.</p>
</div>
<div class="section" id="parameterized-calculations">
<h3>Parameterized Calculations<a class="headerlink" href="#parameterized-calculations" title="Permalink to this headline">¶</a></h3>
<p>Suppose we want to expand the previous example, by calculating the same set
of statistics over 4 sets of courses: 100&#8217;s, 200&#8217;s, 300&#8217;s and 400&#8217;s.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department.define(freshman%20:=%20course?no&gt;=100&amp;no&lt;200,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sophomore%20:=%20course?no&gt;=200&amp;no&lt;300,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20junior%20:=%20course?no&gt;=300&amp;no&lt;400,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20senior%20:=%20course?no&gt;=400&amp;no&lt;500)%0A%20%20%20%20%20%20%20%20%20%20%20{name,%20count(freshman),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(freshman.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(freshman.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(freshman.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(sophomore),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(sophomore.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(sophomore.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(sophomore.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(junior),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(junior.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(junior.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(junior.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(senior),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(senior.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(senior.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(senior.credits)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department.define(freshman%20:=%20course?no&gt;=100&amp;no&lt;200,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sophomore%20:=%20course?no&gt;=200&amp;no&lt;300,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20junior%20:=%20course?no&gt;=300&amp;no&lt;400,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20senior%20:=%20course?no&gt;=400&amp;no&lt;500)%0A%20%20%20%20%20%20%20%20%20%20%20{name,%20count(freshman),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(freshman.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(freshman.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(freshman.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(sophomore),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(sophomore.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(sophomore.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(sophomore.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(junior),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(junior.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(junior.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(junior.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(senior),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(senior.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(senior.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(senior.credits)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="nb">freshman</span> <span class="p">:=</span> <span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">100</span><span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="m">200</span><span class="p">,</span>
                   <span class="nb">sophomore</span> <span class="p">:=</span> <span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">200</span><span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="m">300</span><span class="p">,</span>
                   <span class="nb">junior</span> <span class="p">:=</span> <span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">300</span><span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="m">400</span><span class="p">,</span>
                   <span class="nb">senior</span> <span class="p">:=</span> <span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">400</span><span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="m">500</span><span class="p">)</span>
           <span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nb">freshman</span><span class="p">),</span>
                  <span class="nf">max</span><span class="p">(</span><span class="nb">freshman</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">min</span><span class="p">(</span><span class="nb">freshman</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">avg</span><span class="p">(</span><span class="nb">freshman</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">count</span><span class="p">(</span><span class="nb">sophomore</span><span class="p">),</span>
                  <span class="nf">max</span><span class="p">(</span><span class="nb">sophomore</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">min</span><span class="p">(</span><span class="nb">sophomore</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">avg</span><span class="p">(</span><span class="nb">sophomore</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">count</span><span class="p">(</span><span class="nb">junior</span><span class="p">),</span>
                  <span class="nf">max</span><span class="p">(</span><span class="nb">junior</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">min</span><span class="p">(</span><span class="nb">junior</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">avg</span><span class="p">(</span><span class="nb">junior</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">count</span><span class="p">(</span><span class="nb">senior</span><span class="p">),</span>
                  <span class="nf">max</span><span class="p">(</span><span class="nb">senior</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">min</span><span class="p">(</span><span class="nb">senior</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                  <span class="nf">avg</span><span class="p">(</span><span class="nb">senior</span><span class="p">.</span><span class="nb">credits</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="5%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="5%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="4%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="4%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">count(freshman)</th>
<th class="head">max(freshman.credits)</th>
<th class="head">min(freshman.credits)</th>
<th class="head">avg(freshman.credits)</th>
<th class="head">count(sophomore)</th>
<th class="head">max(sophomore.credits)</th>
<th class="head">min(sophomore.credits)</th>
<th class="head">avg(sophomore.credits)</th>
<th class="head">count(junior)</th>
<th class="head">max(junior.credits)</th>
<th class="head">min(junior.credits)</th>
<th class="head">avg(junior.credits)</th>
<th class="head">count(senior)</th>
<th class="head">max(senior.credits)</th>
<th class="head">min(senior.credits)</th>
<th class="head">avg(senior.credits)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">Accounting</td>
<td class="htsql-integer-type">1</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-decimal-type">2.0</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-decimal-type">3.0</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-decimal-type">4.0</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-decimal-type">3.0</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">Art History</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-integer-type">4</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-decimal-type">3.5</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-decimal-type">3.8</td>
<td class="htsql-integer-type">4</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-decimal-type">3.0</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-decimal-type">3.66666666667</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">Astronomy</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-decimal-type">3.2</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-integer-type">1</td>
<td class="htsql-decimal-type">3.0</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-integer-type">4</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-decimal-type">3.0</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-integer-type">4</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-decimal-type">2.8</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-decimal-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-decimal-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-decimal-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-decimal-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In the above examples, we repeat the same group of aggregates four times,
but each time with different set of courses.  We could write this more
concisely defining a calculation with a parameter.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department.define(freshman%20:=%20course?no&gt;=100&amp;no&lt;200,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sophomore%20:=%20course?no&gt;=200&amp;no&lt;300,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20junior%20:=%20course?no&gt;=300&amp;no&lt;400,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20senior%20:=%20course?no&gt;=400&amp;no&lt;500,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats(set)%20:=%20{count(set),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(set.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(set.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(set.credits)})%0A%20%20%20%20%20%20%20%20%20%20%20{name,%20stats(freshman),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats(sophomore),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats(junior),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats(senior)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department.define(freshman%20:=%20course?no&gt;=100&amp;no&lt;200,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sophomore%20:=%20course?no&gt;=200&amp;no&lt;300,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20junior%20:=%20course?no&gt;=300&amp;no&lt;400,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20senior%20:=%20course?no&gt;=400&amp;no&lt;500,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats(set)%20:=%20{count(set),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(set.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(set.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(set.credits)})%0A%20%20%20%20%20%20%20%20%20%20%20{name,%20stats(freshman),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats(sophomore),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats(junior),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats(senior)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="nb">freshman</span> <span class="p">:=</span> <span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">100</span><span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="m">200</span><span class="p">,</span>
                   <span class="nb">sophomore</span> <span class="p">:=</span> <span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">200</span><span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="m">300</span><span class="p">,</span>
                   <span class="nb">junior</span> <span class="p">:=</span> <span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">300</span><span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="m">400</span><span class="p">,</span>
                   <span class="nb">senior</span> <span class="p">:=</span> <span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="m">400</span><span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="m">500</span><span class="p">,</span>
                   <span class="nf">stats</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span> <span class="p">:=</span> <span class="p">{</span><span class="nf">count</span><span class="p">(</span><span class="nb">set</span><span class="p">),</span>
                                  <span class="nf">max</span><span class="p">(</span><span class="nb">set</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                                  <span class="nf">min</span><span class="p">(</span><span class="nb">set</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                                  <span class="nf">avg</span><span class="p">(</span><span class="nb">set</span><span class="p">.</span><span class="nb">credits</span><span class="p">)})</span>
           <span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">stats</span><span class="p">(</span><span class="nb">freshman</span><span class="p">),</span>
                  <span class="nf">stats</span><span class="p">(</span><span class="nb">sophomore</span><span class="p">),</span>
                  <span class="nf">stats</span><span class="p">(</span><span class="nb">junior</span><span class="p">),</span>
                  <span class="nf">stats</span><span class="p">(</span><span class="nb">senior</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
<p>Here the parameter <tt class="docutils literal"><span class="pre">set</span></tt> is bound to a subset of courses for each grade
level.  The calculation returns a set of columns that appear in the output.</p>
</div>
<div class="section" id="argument-references">
<h3>Argument References<a class="headerlink" href="#argument-references" title="Permalink to this headline">¶</a></h3>
<p>Instead of defining four different subsets of courses, we may want to define
a parameterized calculation which takes a the course level and produces
courses of this level.  Naively, we could write:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department.define(course(level)%20:=%20course?no&gt;=level*100%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;no&lt;(level%2B1)*100)%0A%20%20%20%20%20%20%20%20%20%20%20{name,%20count(course(1)),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(course(2)),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(course(3)),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(course(4))}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department.define(course(level)%20:=%20course?no&gt;=level*100%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;no&lt;(level%2B1)*100)%0A%20%20%20%20%20%20%20%20%20%20%20{name,%20count(course(1)),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(course(2)),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(course(3)),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(course(4))}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="nf">course</span><span class="p">(</span><span class="nb">level</span><span class="p">)</span> <span class="p">:=</span> <span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="nb">level</span><span class="o">*</span><span class="m">100</span>
                                          <span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="p">(</span><span class="nb">level</span><span class="o">+</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="p">)</span>
           <span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nf">course</span><span class="p">(</span><span class="m">1</span><span class="p">)),</span>
                  <span class="nf">count</span><span class="p">(</span><span class="nf">course</span><span class="p">(</span><span class="m">2</span><span class="p">)),</span>
                  <span class="nf">count</span><span class="p">(</span><span class="nf">course</span><span class="p">(</span><span class="m">3</span><span class="p">)),</span>
                  <span class="nf">count</span><span class="p">(</span><span class="nf">course</span><span class="p">(</span><span class="m">4</span><span class="p">))}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<div class="highlight-text"><div class="highlight"><pre>Found unknown attribute:
    course.level
While translating:
    /department.define(course(level) := course?no&gt;=level*100
                                                   ^^^^^
</pre></div>
</div>
</div>
</div>
<p>Here we have a problem with the definition of <tt class="docutils literal"><span class="pre">course(level)</span></tt>.  In the
body of the calculation, <tt class="docutils literal"><span class="pre">course</span></tt> introduces a new naming scope with
attributes from the course table, such as the course <tt class="docutils literal"><span class="pre">no</span></tt>.  Names from the
previous scope, such as <tt class="docutils literal"><span class="pre">level</span></tt>, are not available.  To overcome this
deliberate limitation, we mark <tt class="docutils literal"><span class="pre">level</span></tt> with a dollar sign to indicate that
it can be referenced from nested scopes.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department.define(course($level)%20:=%20course?no&gt;=$level*100%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;no&lt;($level%2B1)*100)%0A%20%20%20%20%20%20%20%20%20%20%20{name,%20count(course(1)),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(course(2)),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(course(3)),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(course(4))}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department.define(course($level)%20:=%20course?no&gt;=$level*100%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;no&lt;($level%2B1)*100)%0A%20%20%20%20%20%20%20%20%20%20%20{name,%20count(course(1)),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(course(2)),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(course(3)),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count(course(4))}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="nf">course</span><span class="p">($</span><span class="nb">level</span><span class="p">)</span> <span class="p">:=</span> <span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="p">$</span><span class="nb">level</span><span class="o">*</span><span class="m">100</span>
                                           <span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="p">($</span><span class="nb">level</span><span class="o">+</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="p">)</span>
           <span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nf">course</span><span class="p">(</span><span class="m">1</span><span class="p">)),</span>
                  <span class="nf">count</span><span class="p">(</span><span class="nf">course</span><span class="p">(</span><span class="m">2</span><span class="p">)),</span>
                  <span class="nf">count</span><span class="p">(</span><span class="nf">course</span><span class="p">(</span><span class="m">3</span><span class="p">)),</span>
                  <span class="nf">count</span><span class="p">(</span><span class="nf">course</span><span class="p">(</span><span class="m">4</span><span class="p">))}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="21%" />
<col width="21%" />
<col width="21%" />
<col width="21%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">count(course(1))</th>
<th class="head">count(course(2))</th>
<th class="head">count(course(3))</th>
<th class="head">count(course(4))</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">Accounting</td>
<td class="htsql-integer-type">1</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-integer-type">3</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">Art History</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-integer-type">4</td>
<td class="htsql-integer-type">3</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">Astronomy</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-integer-type">5</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Using this technique, we could rewrite the last example from the previous
section as:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department.define(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats($level)%20:=%20{count(set),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(set.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(set.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(set.credits)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20}%20:where%20set%20:=%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20course?no&gt;=$level*100%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;no&lt;($level%2B1)*100)%0A%20%20%20%20%20%20%20%20%20%20%20{name,%20stats(1),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats(2),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats(3),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats(4)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department.define(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats($level)%20:=%20{count(set),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20max(set.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min(set.credits),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20avg(set.credits)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20}%20:where%20set%20:=%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20course?no&gt;=$level*100%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;no&lt;($level%2B1)*100)%0A%20%20%20%20%20%20%20%20%20%20%20{name,%20stats(1),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats(2),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats(3),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stats(4)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">.</span><span class="nf">define</span><span class="p">(</span>
              <span class="nf">stats</span><span class="p">($</span><span class="nb">level</span><span class="p">)</span> <span class="p">:=</span> <span class="p">{</span><span class="nf">count</span><span class="p">(</span><span class="nb">set</span><span class="p">),</span>
                                <span class="nf">max</span><span class="p">(</span><span class="nb">set</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                                <span class="nf">min</span><span class="p">(</span><span class="nb">set</span><span class="p">.</span><span class="nb">credits</span><span class="p">),</span>
                                <span class="nf">avg</span><span class="p">(</span><span class="nb">set</span><span class="p">.</span><span class="nb">credits</span><span class="p">)</span>
                                <span class="p">}</span> <span class="p">:</span><span class="nf">where</span> <span class="nb">set</span> <span class="p">:=</span>
                                 <span class="nb">course</span><span class="o">?</span><span class="nb">no</span><span class="o">&gt;=</span><span class="p">$</span><span class="nb">level</span><span class="o">*</span><span class="m">100</span>
                                       <span class="o">&amp;</span><span class="nb">no</span><span class="o">&lt;</span><span class="p">($</span><span class="nb">level</span><span class="o">+</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="p">)</span>
           <span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">stats</span><span class="p">(</span><span class="m">1</span><span class="p">),</span>
                  <span class="nf">stats</span><span class="p">(</span><span class="m">2</span><span class="p">),</span>
                  <span class="nf">stats</span><span class="p">(</span><span class="m">3</span><span class="p">),</span>
                  <span class="nf">stats</span><span class="p">(</span><span class="m">4</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
</div>
<div class="section" id="defined-references">
<h3>Defined References<a class="headerlink" href="#defined-references" title="Permalink to this headline">¶</a></h3>
<p>References are not limited to parameters of calculations, they could be
defined separately.  In the following example <tt class="docutils literal"><span class="pre">$avg_credits</span></tt> defines the
average number of credits per course.  This reference is then used to return
courses with more credits than average.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/define($avg_credits%20:=%20avg(course.credits))%0A.course?credits&gt;$avg_credits" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/define($avg_credits%20:=%20avg(course.credits))%0A.course?credits&gt;$avg_credits" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nf">define</span><span class="p">($</span><span class="nb">avg_credits</span> <span class="p">:=</span> <span class="nf">avg</span><span class="p">(</span><span class="nb">course</span><span class="p">.</span><span class="nb">credits</span><span class="p">))</span>
<span class="p">.</span><span class="nb">course</span><span class="o">?</span><span class="nb">credits</span><span class="o">&gt;</span><span class="p">$</span><span class="nb">avg_credits</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="2%" />
<col width="13%" />
<col width="4%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">title</th>
<th class="head">credits</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">315</td>
<td class="htsql-text-type">Financial Accounting</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-text-type">Integration of the conceptual and computational aspects of asset, liability and stockholders equity accounting.</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">511</td>
<td class="htsql-text-type">Audit</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-text-type">This course considers legal, procedural and ethical aspects of audit in accounting.</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">620</td>
<td class="htsql-text-type">Accounting Internship</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-text-type">Supervised internship in a business or nonprofit organization on an accounting position.</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This same request can be written using <tt class="docutils literal"><span class="pre">where</span></tt>.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course?credits&gt;$avg_credits%0A:where%20$avg_credits%20:=%20avg(course.credits)" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course?credits&gt;$avg_credits%0A:where%20$avg_credits%20:=%20avg(course.credits)" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="o">?</span><span class="nb">credits</span><span class="o">&gt;</span><span class="p">$</span><span class="nb">avg_credits</span>
<span class="p">:</span><span class="nf">where</span> <span class="p">$</span><span class="nb">avg_credits</span> <span class="p">:=</span> <span class="nf">avg</span><span class="p">(</span><span class="nb">course</span><span class="p">.</span><span class="nb">credits</span><span class="p">)</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
<p>Suppose that we&#8217;d like to return courses that have more than average
credits for their given department.  We could write this as follows.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department.define($avg_credits:=avg(course.credits))%0A.course?credits&gt;$avg_credits" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department.define($avg_credits:=avg(course.credits))%0A.course?credits&gt;$avg_credits" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">.</span><span class="nf">define</span><span class="p">($</span><span class="nb">avg_credits</span><span class="p">:=</span><span class="nf">avg</span><span class="p">(</span><span class="nb">course</span><span class="p">.</span><span class="nb">credits</span><span class="p">))</span>
<span class="p">.</span><span class="nb">course</span><span class="o">?</span><span class="nb">credits</span><span class="o">&gt;</span><span class="p">$</span><span class="nb">avg_credits</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="2%" />
<col width="13%" />
<col width="4%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">title</th>
<th class="head">credits</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">315</td>
<td class="htsql-text-type">Financial Accounting</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-text-type">Integration of the conceptual and computational aspects of asset, liability and stockholders equity accounting.</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">511</td>
<td class="htsql-text-type">Audit</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-text-type">This course considers legal, procedural and ethical aspects of audit in accounting.</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">620</td>
<td class="htsql-text-type">Accounting Internship</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-text-type">Supervised internship in a business or nonprofit organization on an accounting position.</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="section" id="projections">
<h2><a class="toc-backref" href="#id4">Projections</a><a class="headerlink" href="#projections" title="Permalink to this headline">¶</a></h2>
<p>So far we have shown queries that produce either scalar values or rows
that correspond to records from a table.  Occasionally, you may want to
return all unique values of some expression.  For example, to return
distinct values of <tt class="docutils literal"><span class="pre">degree</span></tt> from the <tt class="docutils literal"><span class="pre">program</span></tt> table, write:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program^degree" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program^degree" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">program</span><span class="o">^</span><span class="nb">degree</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">degree</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">ba</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">bs</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">ct</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">ma</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">ms</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">pb</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">ph</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In HTSQL, we call this a <em>projection</em>.  This construct creates a virtual
table of all unique records from a set of expressions.</p>
<div class="section" id="distinct-expressions">
<h3>Distinct Expressions<a class="headerlink" href="#distinct-expressions" title="Permalink to this headline">¶</a></h3>
<p>The following example lists values from the degree column for each
record of the program table.  Observe that you get duplicate rows
corresponding to different records from the program table that share the
same degree:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program{degree}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program{degree}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">program</span><span class="p">{</span><span class="nb">degree</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">degree</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">pb</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">ba</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">ba</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">ma</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>To get unique rows from the example above, the <tt class="docutils literal"><span class="pre">distinct()</span></tt> function
can be used:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/distinct(program{degree})" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/distinct(program{degree})" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nf">distinct</span><span class="p">(</span><span class="nb">program</span><span class="p">{</span><span class="nb">degree</span><span class="p">})</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">degree</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">ba</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">bs</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">ct</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Equivalently, this could be written using the <tt class="docutils literal"><span class="pre">^</span></tt> operator:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program^degree" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program^degree" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">program</span><span class="o">^</span><span class="nb">degree</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">degree</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">ba</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">bs</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">ct</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note that the projection operator skips rows containing a <em>NULL</em>.
Hence, even though there are rows in the program without a degree,
<tt class="docutils literal"><span class="pre">program^degree</span></tt> doesn&#8217;t contain a <em>NULL</em>.</p>
<p>You could use projections anywhere a table expression is permitted.
For instance, to get the number of distinct degrees offered at the
university, write:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/count(program^degree)" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/count(program^degree)" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nf">count</span><span class="p">(</span><span class="nb">program</span><span class="o">^</span><span class="nb">degree</span><span class="p">)</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
</thead>
<tbody valign="top">
<tr class="row-odd"><td class="htsql-integer-type">7</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Or, one could count distinct degrees by school:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school{name,%20count(program^degree)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school{name,%20count(program^degree)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">school</span><span class="p">{</span><span class="nb">name</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nb">program</span><span class="o">^</span><span class="nb">degree</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">count(program^degree)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">School of Art &amp; Design</td>
<td class="htsql-integer-type">2</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">School of Business</td>
<td class="htsql-integer-type">4</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">College of Education</td>
<td class="htsql-integer-type">4</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Projections aren&#8217;t limited to table attributes.  Let&#8217;s assume course
level as the first digit of the course number.  Then, hence following
expression returns distinct course levels:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course^trunc(no/100)" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course^trunc(no/100)" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="o">^</span><span class="nf">trunc</span><span class="p">(</span><span class="nb">no</span><span class="o">/</span><span class="m">100</span><span class="p">)</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">trunc(no/100)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-decimal-type">1</td>
</tr>
<tr class="row-odd"><td class="htsql-decimal-type">2</td>
</tr>
<tr class="row-even"><td class="htsql-decimal-type">3</td>
</tr>
<tr class="row-odd"><td class="htsql-decimal-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>If you wish to project by more than one expression, use a selector
<tt class="docutils literal"><span class="pre">{}</span></tt> to group the expressions.  In this example we return distinct
combinations of course level and credits.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course^{trunc(no/100),%20credits}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course^{trunc(no/100),%20credits}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="o">^</span><span class="p">{</span><span class="nf">trunc</span><span class="p">(</span><span class="nb">no</span><span class="o">/</span><span class="m">100</span><span class="p">),</span> <span class="nb">credits</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="65%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">trunc(no/100)</th>
<th class="head">credits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-decimal-type">1</td>
<td class="htsql-integer-type">2</td>
</tr>
<tr class="row-odd"><td class="htsql-decimal-type">1</td>
<td class="htsql-integer-type">3</td>
</tr>
<tr class="row-even"><td class="htsql-decimal-type">1</td>
<td class="htsql-integer-type">4</td>
</tr>
<tr class="row-odd"><td class="htsql-decimal-type">1</td>
<td class="htsql-integer-type">5</td>
</tr>
<tr class="row-even"><td class="htsql-decimal-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Just as tables are sorted by default using the table&#8217;s primary key,
projected expressions are also sorted using the distinct columns.</p>
</div>
<div class="section" id="working-with-projections">
<h3>Working with Projections<a class="headerlink" href="#working-with-projections" title="Permalink to this headline">¶</a></h3>
<p>Each projection is a virtual table with its own attributes and links to
other tables.  For instance, <tt class="docutils literal"><span class="pre">program^degree</span></tt> has two attributes, a
column <tt class="docutils literal"><span class="pre">degree</span></tt> and a plural link <tt class="docutils literal"><span class="pre">program</span></tt> to records of the
program table having that degree.  In the query below, we return
distinct degrees with the number of corresponding programs.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program^degree%20{degree,%20count(program)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program^degree%20{degree,%20count(program)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">program</span><span class="o">^</span><span class="nb">degree</span> <span class="p">{</span><span class="nb">degree</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="nb">program</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">degree</th>
<th class="head">count(program)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">ba</td>
<td class="htsql-integer-type">10</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">bs</td>
<td class="htsql-integer-type">10</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">ct</td>
<td class="htsql-integer-type">4</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">ma</td>
<td class="htsql-integer-type">7</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We may want to filter the base table before projecting.  For example,
listing only distinct degrees in the School of Engineering.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program?school_code='eng'%0A%20%20%20%20%20%20%20%20^degree" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program?school_code='eng'%0A%20%20%20%20%20%20%20%20^degree" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">program</span><span class="o">?</span><span class="nb">school_code</span><span class="o">=</span><span class="s">&#39;eng&#39;</span>
        <span class="o">^</span><span class="nb">degree</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">degree</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">bs</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">ms</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Or, we could filter the expression after the projection has happened.
In the next query we return only degrees having more than 5
corresponding programs.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program^degree%0A%20%20%20%20%20%20%20%20?count(program)&gt;5" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program^degree%0A%20%20%20%20%20%20%20%20?count(program)&gt;5" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">program</span><span class="o">^</span><span class="nb">degree</span>
        <span class="o">?</span><span class="nf">count</span><span class="p">(</span><span class="nb">program</span><span class="p">)</span><span class="o">&gt;</span><span class="m">5</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">degree</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">ba</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">bs</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">ma</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">ms</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Usually HTSQL automatically assigns names to projected columns, however,
in cases where you have an expression, you have to name them.  In the
following example, we return distinct course level and credits
combinations sorted in descending order by level and credits.</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course^{level:=round(no/100),credits}{level-,%20credits-}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course^{level:=round(no/100),credits}{level-,%20credits-}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="o">^</span><span class="p">{</span><span class="nb">level</span><span class="p">:=</span><span class="nf">round</span><span class="p">(</span><span class="nb">no</span><span class="o">/</span><span class="m">100</span><span class="p">),</span><span class="nb">credits</span><span class="p">}{</span><span class="nb">level</span><span class="o">-</span><span class="p">,</span> <span class="nb">credits</span><span class="o">-</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">level</th>
<th class="head">credits</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-decimal-type">8</td>
<td class="htsql-integer-type">3</td>
</tr>
<tr class="row-odd"><td class="htsql-decimal-type">7</td>
<td class="htsql-integer-type">4</td>
</tr>
<tr class="row-even"><td class="htsql-decimal-type">7</td>
<td class="htsql-integer-type">3</td>
</tr>
<tr class="row-odd"><td class="htsql-decimal-type">7</td>
<td class="htsql-integer-type">0</td>
</tr>
<tr class="row-even"><td class="htsql-decimal-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Sometimes HTSQL cannot assign a name linking to the base of the
projection.  In these cases, you may use <tt class="docutils literal"><span class="pre">^</span></tt> to refer to it.
Additionally <tt class="docutils literal"><span class="pre">*</span></tt> can be used to return all columns of the projection.
Thus, the first example of this section could be written:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program^degree{*,%20count(^)}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program^degree{*,%20count(^)}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">program</span><span class="o">^</span><span class="nb">degree</span><span class="p">{</span><span class="o">*</span><span class="p">,</span> <span class="nf">count</span><span class="p">(</span><span class="o">^</span><span class="p">)}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">degree</th>
<th class="head">count(^)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">ba</td>
<td class="htsql-integer-type">10</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">bs</td>
<td class="htsql-integer-type">10</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">ct</td>
<td class="htsql-integer-type">4</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">ma</td>
<td class="htsql-integer-type">7</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="section" id="logical-expressions">
<h2><a class="toc-backref" href="#id5">Logical Expressions</a><a class="headerlink" href="#logical-expressions" title="Permalink to this headline">¶</a></h2>
<p>A <em>filter</em> refines results by including or excluding data by specific
criteria.  This section reviews comparison operators, boolean
expressions, and <tt class="docutils literal"><span class="pre">NULL</span></tt> handling.</p>
<div class="section" id="comparison-operators">
<h3>Comparison Operators<a class="headerlink" href="#comparison-operators" title="Permalink to this headline">¶</a></h3>
<p>The equality operator (<tt class="docutils literal"><span class="pre">=</span></tt>) is overloaded to support various types.
For character strings, this depends upon the underlying database&#8217;s
collation rules but typically is case-sensitive.  For example, to return
a <tt class="docutils literal"><span class="pre">department</span></tt> by <tt class="docutils literal"><span class="pre">name</span></tt>:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department?name='Economics'" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department?name='Economics'" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="o">?</span><span class="nb">name</span><span class="o">=</span><span class="s">&#39;Economics&#39;</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="38%" />
<col width="46%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">econ</td>
<td class="htsql-text-type">Economics</td>
<td class="htsql-text-type">bus</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>If you&#8217;re not sure of the exact department name, use the case-insensitive
<em>contains</em> operator (<tt class="docutils literal"><span class="pre">~</span></tt>).  The example below returns all <tt class="docutils literal"><span class="pre">department</span></tt>
records that contain the substring <tt class="docutils literal"><span class="pre">'engineering'</span></tt>:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department?name~'engineering'" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department?name~'engineering'" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="o">?</span><span class="nb">name</span><span class="o">~</span><span class="s">&#39;engineering&#39;</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="59%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">be</td>
<td class="htsql-text-type">Bioengineering</td>
<td class="htsql-text-type">eng</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">ee</td>
<td class="htsql-text-type">Electrical Engineering</td>
<td class="htsql-text-type">eng</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">me</td>
<td class="htsql-text-type">Mechanical Engineering</td>
<td class="htsql-text-type">eng</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Use the <em>not-contains</em> operator (<tt class="docutils literal"><span class="pre">!~</span></tt>) to exclude all courses with
<em>science</em> in the name:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department?name!~'science'" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department?name!~'science'" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="o">?</span><span class="nb">name</span><span class="o">!~</span><span class="s">&#39;science&#39;</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
<p>To exclude a specific department, use the <em>not-equals</em> operator:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department?name!='Management%20&amp;%20Marketing'" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department?name!='Management%20&amp;%20Marketing'" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="o">?</span><span class="nb">name</span><span class="o">!=</span><span class="s">&#39;Management &amp; Marketing&#39;</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
<p>The <em>equality</em> (<tt class="docutils literal"><span class="pre">=</span></tt>) and <em>inequality</em> (<tt class="docutils literal"><span class="pre">!=</span></tt>) operators are
straightforward when used with numbers:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department?count(course)!=0" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department?count(course)!=0" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="o">?</span><span class="nf">count</span><span class="p">(</span><span class="nb">course</span><span class="p">)</span><span class="o">!=</span><span class="m">0</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="39%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-text-type">Accounting</td>
<td class="htsql-text-type">bus</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">arthis</td>
<td class="htsql-text-type">Art History</td>
<td class="htsql-text-type">la</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <em>in</em> operator (<tt class="docutils literal"><span class="pre">={}</span></tt>) can be thought of as equality over a set.
This example, we return departments that don&#8217;t belong to either the
School of Engineering or the School of Natural Sciences:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department?school_code!={'eng','ns'}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department?school_code!={'eng','ns'}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="o">?</span><span class="nb">school_code</span><span class="o">!=</span><span class="p">{</span><span class="s">&#39;eng&#39;</span><span class="p">,</span><span class="s">&#39;ns&#39;</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
<p>Use the <em>greater-than</em> (<tt class="docutils literal"><span class="pre">&gt;</span></tt>) operator to request departments with
more than 20 offered courses:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department?count(course)&gt;20" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department?count(course)&gt;20" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="o">?</span><span class="nf">count</span><span class="p">(</span><span class="nb">course</span><span class="p">)</span><span class="o">&gt;</span><span class="m">20</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="52%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">astro</td>
<td class="htsql-text-type">Astronomy</td>
<td class="htsql-text-type">ns</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">comp</td>
<td class="htsql-text-type">Computer Science</td>
<td class="htsql-text-type">eng</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">eng</td>
<td class="htsql-text-type">English</td>
<td class="htsql-text-type">la</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">lang</td>
<td class="htsql-text-type">Foreign Languages</td>
<td class="htsql-text-type">la</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Use the <em>greater-than-or-equal-to</em> (<tt class="docutils literal"><span class="pre">&gt;=</span></tt>) operator to request
departments with 20 courses or more:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department?count(course)&gt;=20" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department?count(course)&gt;=20" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="o">?</span><span class="nf">count</span><span class="p">(</span><span class="nb">course</span><span class="p">)</span><span class="o">&gt;=</span><span class="m">20</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
<p>Using comparison operators with strings tells HTSQL to compare them
alphabetically (once again, dependent upon database&#8217;s collation).  For
example, the <em>greater-than</em> (<tt class="docutils literal"><span class="pre">&gt;</span></tt>) operator can be used to request
departments whose <tt class="docutils literal"><span class="pre">code</span></tt> follows <tt class="docutils literal"><span class="pre">'me'</span></tt> in the alphabet:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department?code&gt;'me'" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department?code&gt;'me'" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="o">?</span><span class="nb">code</span><span class="o">&gt;</span><span class="s">&#39;me&#39;</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">mm</td>
<td class="htsql-text-type">Management &amp; Marketing</td>
<td class="htsql-text-type">bus</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">mth</td>
<td class="htsql-text-type">Mathematics</td>
<td class="htsql-text-type">ns</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">parent</td>
<td class="htsql-text-type">Parents &amp; Alumni</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">phys</td>
<td class="htsql-text-type">Physics</td>
<td class="htsql-text-type">ns</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="boolean-expressions">
<h3>Boolean Expressions<a class="headerlink" href="#boolean-expressions" title="Permalink to this headline">¶</a></h3>
<p>HTSQL uses function notation for constants such as <tt class="docutils literal"><span class="pre">true()</span></tt>, <tt class="docutils literal"><span class="pre">false()</span></tt>
and <tt class="docutils literal"><span class="pre">null()</span></tt>.  For the text formatter, a <tt class="docutils literal"><span class="pre">NULL</span></tt> is shown as a blank,
while the empty string is presented as a double-quoted pair:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/{true(),%20false(),%20null(),%20''}" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/{true(),%20false(),%20null(),%20''}" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="p">{</span><span class="nf">true</span><span class="p">(),</span> <span class="nf">false</span><span class="p">(),</span> <span class="nf">null</span><span class="p">(),</span> <span class="s">&#39;&#39;</span><span class="p">}</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="33%" />
<col width="29%" />
<col width="10%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">true()</th>
<th class="head">false()</th>
<th class="head">null()</th>
<th class="head">&#8216;&#8217;</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-boolean-type htsql-true-val">true</td>
<td class="htsql-boolean-type htsql-false-val">false</td>
<td class="htsql-untyped-type htsql-null-val"></td>
<td class="htsql-untyped-type htsql-empty-val"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <tt class="docutils literal"><span class="pre">is_null()</span></tt> function returns <tt class="docutils literal"><span class="pre">true()</span></tt> if it&#8217;s operand is
<tt class="docutils literal"><span class="pre">null()</span></tt>.  In our schema, non-academic <tt class="docutils literal"><span class="pre">department</span></tt> records with
a <tt class="docutils literal"><span class="pre">NULL</span></tt> <tt class="docutils literal"><span class="pre">school_code</span></tt> can be listed:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department{code,%20name}?is_null(school_code)" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department{code,%20name}?is_null(school_code)" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">{</span><span class="nb">code</span><span class="p">,</span> <span class="nb">name</span><span class="p">}</span><span class="o">?</span><span class="nf">is_null</span><span class="p">(</span><span class="nb">school_code</span><span class="p">)</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">bursar</td>
<td class="htsql-text-type">Bursar&#8217;s Office</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">career</td>
<td class="htsql-text-type">Career Development</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">parent</td>
<td class="htsql-text-type">Parents &amp; Alumni</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <em>negation</em> operator (<tt class="docutils literal"><span class="pre">!</span></tt>) is <tt class="docutils literal"><span class="pre">true()</span></tt> when it&#8217;s operand is
<tt class="docutils literal"><span class="pre">false()</span></tt>.   To skip non-academic <tt class="docutils literal"><span class="pre">department</span></tt> records:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department{code,%20name}?!is_null(school_code)" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department{code,%20name}?!is_null(school_code)" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="p">{</span><span class="nb">code</span><span class="p">,</span> <span class="nb">name</span><span class="p">}</span><span class="o">?!</span><span class="nf">is_null</span><span class="p">(</span><span class="nb">school_code</span><span class="p">)</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-text-type">Accounting</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">arthis</td>
<td class="htsql-text-type">Art History</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">astro</td>
<td class="htsql-text-type">Astronomy</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">be</td>
<td class="htsql-text-type">Bioengineering</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <em>conjunction</em> (<tt class="docutils literal"><span class="pre">&amp;</span></tt>) operator is <tt class="docutils literal"><span class="pre">true()</span></tt> only if both of its
operands are <tt class="docutils literal"><span class="pre">true()</span></tt>.   This example asks for courses in the
<tt class="docutils literal"><span class="pre">'Accounting'</span></tt> department having less than 3 credits:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course?department_code='acc'&amp;credits&lt;3" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course?department_code='acc'&amp;credits&lt;3" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="o">?</span><span class="nb">department_code</span><span class="o">=</span><span class="s">&#39;acc&#39;</span><span class="o">&amp;</span><span class="nb">credits</span><span class="o">&lt;</span><span class="m">3</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="5%" />
<col width="37%" />
<col width="12%" />
<col width="19%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">title</th>
<th class="head">credits</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">100</td>
<td class="htsql-text-type">Practical Bookkeeping</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <em>alternation</em> (<tt class="docutils literal"><span class="pre">|</span></tt>) operator is <tt class="docutils literal"><span class="pre">true()</span></tt> if either of its
operands is <tt class="docutils literal"><span class="pre">true()</span></tt>.  For example, we could list courses having
anomalous number of credits:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course?credits&gt;5|credits&lt;3" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course?credits&gt;5|credits&lt;3" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="o">?</span><span class="nb">credits</span><span class="o">&gt;</span><span class="m">5</span><span class="o">|</span><span class="nb">credits</span><span class="o">&lt;</span><span class="m">3</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="2%" />
<col width="20%" />
<col width="5%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">title</th>
<th class="head">credits</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">100</td>
<td class="htsql-text-type">Practical Bookkeeping</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">620</td>
<td class="htsql-text-type">Accounting Internship</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-text-type">Supervised internship in a business or nonprofit organization on an accounting position.</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">arthis</td>
<td class="htsql-integer-type">209</td>
<td class="htsql-text-type">Antique Art: Greece and Rome</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-text-type">Visual art of antique period with emphasis on Greek and Roman art.</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">astro</td>
<td class="htsql-integer-type">106</td>
<td class="htsql-text-type">General Astronomy I Lab</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-text-type">Laboratory studies that complement the lecture course.</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The precedence rules for boolean operators follow typical programming
convention; negation binds more tightly than conjunction, which binds
more tightly than alternation.  Parenthesis can be used to override this
default grouping rule or to better clarify intent.  The next example
returns courses that are in &#8220;Art History&#8221; or &#8220;Studio Art&#8221; departments
that have more than three credits:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course?(department_code='arthis'|department_code='stdart')&amp;credits&gt;3" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course?(department_code='arthis'|department_code='stdart')&amp;credits&gt;3" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="o">?</span><span class="p">(</span><span class="nb">department_code</span><span class="o">=</span><span class="s">&#39;arthis&#39;</span><span class="o">|</span><span class="nb">department_code</span><span class="o">=</span><span class="s">&#39;stdart&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="nb">credits</span><span class="o">&gt;</span><span class="m">3</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="2%" />
<col width="19%" />
<col width="5%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">title</th>
<th class="head">credits</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">arthis</td>
<td class="htsql-integer-type">102</td>
<td class="htsql-text-type">History of Art Criticism I</td>
<td class="htsql-integer-type">4</td>
<td class="htsql-text-type">An introductory survey course of world art from Prehistoric through late-Medieval art history.</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">arthis</td>
<td class="htsql-integer-type">209</td>
<td class="htsql-text-type">Antique Art: Greece and Rome</td>
<td class="htsql-integer-type">6</td>
<td class="htsql-text-type">Visual art of antique period with emphasis on Greek and Roman art.</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">arthis</td>
<td class="htsql-integer-type">210</td>
<td class="htsql-text-type">Antique Art: The Middle East</td>
<td class="htsql-integer-type">4</td>
<td class="htsql-text-type">Visual art of ancient world civilizations: Egypt, Mesopotamia, Persia.</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">arthis</td>
<td class="htsql-integer-type">476</td>
<td class="htsql-text-type">Islamic Art</td>
<td class="htsql-integer-type">5</td>
<td class="htsql-text-type">History of Islamic visual arts and their religious value.</td>
</tr>
<tr class="row-even"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Without the parenthesis, the expression above would show all courses
from <tt class="docutils literal"><span class="pre">'arthis'</span></tt> regardless of credits:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course?department_code='arthis'|department_code='stdart'&amp;credits&gt;3" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course?department_code='arthis'|department_code='stdart'&amp;credits&gt;3" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="o">?</span><span class="nb">department_code</span><span class="o">=</span><span class="s">&#39;arthis&#39;</span><span class="o">|</span><span class="nb">department_code</span><span class="o">=</span><span class="s">&#39;stdart&#39;</span><span class="o">&amp;</span><span class="nb">credits</span><span class="o">&gt;</span><span class="m">3</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="2%" />
<col width="18%" />
<col width="5%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">title</th>
<th class="head">credits</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">arthis</td>
<td class="htsql-integer-type">102</td>
<td class="htsql-text-type">History of Art Criticism I</td>
<td class="htsql-integer-type">4</td>
<td class="htsql-text-type">An introductory survey course of world art from Prehistoric through late-Medieval art history.</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">arthis</td>
<td class="htsql-integer-type">103</td>
<td class="htsql-text-type">History of Art Criticism II</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-text-type">An introductory survey course of world art from 15th century through the present.</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">arthis</td>
<td class="htsql-integer-type">204</td>
<td class="htsql-text-type">North American Native Art</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-text-type">Visual art of North American natives from prehistoric times to the present day.</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>When a non-boolean is used in a logical expression, it is implicitly
cast as a <em>boolean</em>.  As part of this cast, tri-value logic is
flattened, <tt class="docutils literal"><span class="pre">null()</span></tt> is converted into <tt class="docutils literal"><span class="pre">false()</span></tt>.  For strings, the
empty string (<tt class="docutils literal"><span class="pre">''</span></tt>) is also treated as <tt class="docutils literal"><span class="pre">false()</span></tt>.  This conversion
rule shortens URLs and makes them more readable.</p>
<p>For example, this query returns only <tt class="docutils literal"><span class="pre">course</span></tt> records having a
<tt class="docutils literal"><span class="pre">description</span></tt>:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course?description" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course?description" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="o">?</span><span class="nb">description</span>
</pre></div>
</a></pre></div></div>
</div>
</div>
<p>The predicate <tt class="docutils literal"><span class="pre">?description</span></tt> is treated as a short-hand for
<tt class="docutils literal"><span class="pre">?(!is_null(description)&amp;description!='')</span></tt>.  The negated variant of
this shortcut is more illustrative:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course{department_code,no,description}?%20!description" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course{department_code,no,description}?%20!description" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">course</span><span class="p">{</span><span class="nb">department_code</span><span class="p">,</span><span class="nb">no</span><span class="p">,</span><span class="nb">description</span><span class="p">}</span><span class="o">?</span> <span class="o">!</span><span class="nb">description</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="52%" />
<col width="10%" />
<col width="38%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">100</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">tched</td>
<td class="htsql-integer-type">630</td>
<td class="htsql-text-type htsql-empty-val"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="section" id="types-and-functions">
<h2><a class="toc-backref" href="#id6">Types and Functions</a><a class="headerlink" href="#types-and-functions" title="Permalink to this headline">¶</a></h2>
<p>HTSQL supports <em>boolean</em>, <em>date</em>, <em>numeric</em>, and <em>string</em> data types, as
well as variants.  The pluggable type system can be used to augment the
core types provided.</p>
<div class="section" id="working-with-nulls">
<h3>Working with NULLs<a class="headerlink" href="#working-with-nulls" title="Permalink to this headline">¶</a></h3>
<p>HTSQL provides a rich function set for handling <tt class="docutils literal"><span class="pre">NULL</span></tt> expressions;
however, careful attention must be paid.  For starters, the standard
equality operator (<tt class="docutils literal"><span class="pre">=</span></tt>) is null-regular, that is, if either operand is
<tt class="docutils literal"><span class="pre">null()</span></tt> the result is <tt class="docutils literal"><span class="pre">null()</span></tt>.  The following request always
returns 0 rows:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department?school_code=null()" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department?school_code=null()" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="o">?</span><span class="nb">school_code</span><span class="o">=</span><span class="nf">null</span><span class="p">()</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
</tr>
</thead>
<tbody valign="top">
</tbody>
</table>
</div>
</div>
<p>While you wouldn&#8217;t directly write that query, it could be the final
result after parameter substitution for a templatized query such as
<tt class="docutils literal"><span class="pre">/department?school=$var</span></tt>.  For cases like this, use <em>total equality</em>
operator (<tt class="docutils literal"><span class="pre">==</span></tt>) which treats <tt class="docutils literal"><span class="pre">NULL</span></tt> values as equivalent:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department?school_code==null()" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department?school_code==null()" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="o">?</span><span class="nb">school_code</span><span class="o">==</span><span class="nf">null</span><span class="p">()</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="51%" />
<col width="31%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">bursar</td>
<td class="htsql-text-type">Bursar&#8217;s Office</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">career</td>
<td class="htsql-text-type">Career Development</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-even"><td class="htsql-text-type">parent</td>
<td class="htsql-text-type">Parents &amp; Alumni</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <tt class="docutils literal"><span class="pre">!==</span></tt> operator lists distinct values, including records with
a <tt class="docutils literal"><span class="pre">NULL</span></tt> for the field tested:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department?school_code!=='art'" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department?school_code!=='art'" target="_new" class="htsql-link"><div class="highlight"><pre><span class="o">/</span><span class="nb">department</span><span class="o">?</span><span class="nb">school_code</span><span class="o">!==</span><span class="s">&#39;art&#39;</span>
</pre></div>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="47%" />
<col width="34%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="htsql-text-type">acc</td>
<td class="htsql-text-type">Accounting</td>
<td class="htsql-text-type">bus</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">arthis</td>
<td class="htsql-text-type">Art History</td>
<td class="htsql-text-type">la</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">astro</td>
<td class="htsql-text-type">Astronomy</td>
<td class="htsql-text-type">ns</td>
</tr>
<tr class="row-odd"><td class="htsql-text-type">be</td>
<td class="htsql-text-type">Bioengineering</td>
<td class="htsql-text-type">eng</td>
</tr>
<tr class="row-even"><td class="htsql-text-type">bursar</td>
<td class="htsql-text-type">Bursar&#8217;s Office</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr class="row-odd"><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

  <div class="footer">
    <div class="footer-inner">
      <span class="copyright">
        Copyright &copy; 2006-2012
        <a href="http://prometheusresearch.com/">Prometheus Research LLC</a>
      </span>
      <ul class="community-links">
        <li><a href="/index.rss">RSS</a></li>
        <li><a href="http://twitter.com/htsql">twitter</a></li>
        <li><a href="irc://irc.freenode.net#htsql">IRC</a></li>
        <li><a href="http://lists.htsql.org/mailman/listinfo/htsql-users">mailing list</a></li>
        <li><a href="http://bitbucket.org/prometheus/htsql/issues/new">report a bug</a></li>
        <li><a href="http://bitbucket.org/prometheus/htsql/">source code</a></li>
        <li><a href="http://prometheusresearch.com/">commercial support</a></li>
      </ul>
    </div>
  </div>

  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-11527623-4']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>


  </body>
</html>